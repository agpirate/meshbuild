import{u as B,o as G,N as q,r as L,a_ as K,w as x,a$ as $,b0 as R,g as Q,s as X,b1 as Y,c as M}from"./index.39fdb616.js";import{_ as N,p as Z}from"./debugMixin.369f3227.js";function ee(e){return $()?(R(e),!0):!1}function U(e){return typeof e=="function"?e():B(e)}const T=typeof window!="undefined"&&typeof document!="undefined";typeof WorkerGlobalScope!="undefined"&&globalThis instanceof WorkerGlobalScope;const te=Object.prototype.toString,ne=e=>te.call(e)==="[object Object]",re=()=>{};function ae(e,n){function t(...a){return new Promise((u,g)=>{Promise.resolve(e(()=>n.apply(this,a),{fn:n,thisArg:this,args:a})).then(u).catch(g)})}return t}const H=e=>e();function oe(e=H){const n=L(!0);function t(){n.value=!1}function a(){n.value=!0}const u=(...g)=>{n.value&&e(...g)};return{isActive:K(n),pause:t,resume:a,eventFilter:u}}function le(e){return e||Q()}function ie(e,n,t={}){const{eventFilter:a=H,...u}=t;return x(e,ae(a,n),u)}function ue(e,n,t={}){const{eventFilter:a,...u}=t,{eventFilter:g,pause:v,resume:b,isActive:m}=oe(a);return{stop:ie(e,n,{...u,eventFilter:g}),pause:v,resume:b,isActive:m}}function se(e,n=!0,t){le()?G(e,t):n?e():q(e)}function ce(e){var n;const t=U(e);return(n=t==null?void 0:t.$el)!=null?n:t}const W=T?window:void 0;T&&window.document;T&&window.navigator;T&&window.location;function V(...e){let n,t,a,u;if(typeof e[0]=="string"||Array.isArray(e[0])?([t,a,u]=e,n=W):[n,t,a,u]=e,!n)return re;Array.isArray(t)||(t=[t]),Array.isArray(a)||(a=[a]);const g=[],v=()=>{g.forEach(y=>y()),g.length=0},b=(y,f,i,o)=>(y.addEventListener(f,i,o),()=>y.removeEventListener(f,i,o)),m=x(()=>[ce(n),U(u)],([y,f])=>{if(v(),!y)return;const i=ne(f)?{...f}:f;g.push(...t.flatMap(o=>a.map(w=>b(y,o,w,i))))},{immediate:!0,flush:"post"}),h=()=>{m(),v()};return ee(h),h}const D=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},I="__vueuse_ssr_handlers__",fe=de();function de(){return I in D||(D[I]=D[I]||{}),D[I]}function ge(e,n){return fe[e]||n}function pe(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"?"object":Number.isNaN(e)?"any":"number"}const ye={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},z="vueuse-storage";function P(e,n,t,a={}){var u;const{flush:g="pre",deep:v=!0,listenToStorageChanges:b=!0,writeDefaults:m=!0,mergeDefaults:h=!1,shallow:y,window:f=W,eventFilter:i,onError:o=r=>{console.error(r)},initOnMounted:w}=a,s=(y?X:L)(typeof n=="function"?n():n);if(!t)try{t=ge("getDefaultStorage",()=>{var r;return(r=W)==null?void 0:r.localStorage})()}catch(r){o(r)}if(!t)return s;const l=U(n),d=pe(l),S=(u=a.serializer)!=null?u:ye[d],{pause:_,resume:j}=ue(s,()=>k(s.value),{flush:g,deep:v,eventFilter:i});f&&b&&se(()=>{V(f,"storage",O),V(f,z,E),w&&O()}),w||O();function F(r,c){f&&f.dispatchEvent(new CustomEvent(z,{detail:{key:e,oldValue:r,newValue:c,storageArea:t}}))}function k(r){try{const c=t.getItem(e);if(r==null)F(c,null),t.removeItem(e);else{const A=S.write(r);c!==A&&(t.setItem(e,A),F(c,A))}}catch(c){o(c)}}function C(r){const c=r?r.newValue:t.getItem(e);if(c==null)return m&&l!=null&&t.setItem(e,S.write(l)),l;if(!r&&h){const A=S.read(c);return typeof h=="function"?h(A,l):d==="object"&&!Array.isArray(A)?{...l,...A}:A}else return typeof c!="string"?c:S.read(c)}function O(r){if(!(r&&r.storageArea!==t)){if(r&&r.key==null){s.value=l;return}if(!(r&&r.key!==e)){_();try{(r==null?void 0:r.newValue)!==S.write(s.value)&&(s.value=C(r))}catch(c){o(c)}finally{r?q(j):j()}}}}function E(r){O(r.detail)}return s}function p(e,n,t={}){const{window:a=W}=t;return P(e,n,a==null?void 0:a.localStorage,t)}function J(e,n,t={}){const{window:a=W}=t;return P(e,n,a==null?void 0:a.sessionStorage,t)}const we="/api";var Se=we+"/login";const he="authenticatingStore";var ve={_isRegistered:!1,user:{},cookies:"",enrolled:!1},_e=Y(he,()=>{let e=L(ve),n=L(null),t=L(null);L(null);let a=M(()=>e.value),u=M(()=>n.value),g=M(()=>t.value);function v(i=null){return!0}async function b(i=null,o=null,w=null){var s,l,d,S;if(i!=null&&i){let _=i!=null?i:!1;t.value=p("_isRegistered",_)}if(console.log("loging UserData",o),o&&Object.keys(o).length){n.value=p("user",o,{mergeDefaults:!0});try{p("userID",(s=o.id)!=null?s:""),p("acctype",(l=o.acctype)!=null?l:"",{mergeDefaults:!0}),J("token",(d=o.token)!=null?d:""),J("qw",o.queryWeight[1]),J("userID",(S=o.id)!=null?S:"")}catch(_){console.log("Loging e",_,o.acckey)}}else n.value=p("user",n.value);return!0}async function m(){return N._clear(),p("_isRegistered",null),p("user",null),p("userID",null),N._clear("userID"),p("phone",null),N._clear("phone"),p("_acctype",null),!0}let h=["phone","id"];async function y(i={}){var w,s;let o=N._get("enrolled");if(i=Object.assign(i,(w=await f())!=null?w:i),console.log("((1)) Incoming User/Storage Data "+i),((s=i[h[0]])!=null?s:i[h[1]])==null)return{status:!1,data:"LogIn Keys :"+i};await m(),console.error("Clearing Storage"),console.log(i);try{return await Z.post(Se,i).then(async l=>{var S,_,j,F,k,C,O;let d=(S=l.data.acctype)!=null?S:!1;if(console.log("((2)) Response User/Storage Data "+l.data),l.status&&d){l.data.acctype={},l.data.group=(_=d.group)!=null?_:"",l.data.acctype.group=(j=d.group)!=null?j:"";for(let E in d)((F=d[E].capability)!=null?F:!1)&&d[E].capability!="00000"&&(l.data.acctype[E]=Object.assign({group:d.group},d[E]));Boolean(o)?(N._set("enrolled",o),l.data.enrolled=!0):(C=(k=l.data)==null?void 0:k.enrolled)!=null&&C&&N._set("enrolled",String((O=l.data.enrolled)!=null?O:!1)),console.log("stored rolle ",o,typeof o),await b(!0,l.data,"true")}return l}).catch(l=>({status:!1,data:l}))}catch(l){return{status:!1,data:l}}}async function f(){var w,s;var i=Boolean((w=p("_isRegistered").value)!=null?w:!1);let o=(s=p("userID").value)!=null?s:null;return i&&o?{id:o}:null}return{getLogStatus:a,getLogisREgistered:g,getLogUser:u,set_reqHeader:v,setlogStatus:b,clearlogStatus:m,useLogin:y}});export{_e as a,p as u};
