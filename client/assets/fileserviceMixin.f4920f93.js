import{r as a}from"./index.39fdb616.js";const I=()=>{let r=a(null),g=a(null),d=a(null),p=a(!1),s=a([]),n=a([]),w=a([]),c=a(0),m=a(!1);a(0),a(!0);async function U(u,e){let l=u.target.files==null||u.target.files.length==0?!1:u.target.files;if(l){await h(),g.value=e,d.value="folder";for(let t=0;t<l.length;t++)s.value.push(l[t]),n.value.push(URL.createObjectURL(l[t]))}}let i=a({}),D=a("");i.value.width=100,i.value.height=100;async function h(){return g.value=null,d.value=null,p.value=!1,w.value=[],n.value=[],s.value=[],c.value=0,m.value=!1,!0}async function A(u){var e;return(e=m.value)!=null&&e?(n.value.splice(u,1),s.value.splice(u,1),c.value=0):c.value=u,!0}async function N(u){var e;return(e=m.value)!=null&&e?(w.value.splice(u,1),c.value=0):c.value=u,!0}let S=a({}),M=a([]),C=a([]),f=a(!1),_=a(!0),R=a(""),o=a(""),v=a({});a(""),a("");const b=a(!1),E=a({facingMode:"user",aspectRatio:{min:1,max:1.7777777778},width:{min:1280},height:{min:720}});class j{constructor(){console.error("Init.. Device Naviator")}async _navigateDevice(){var l,t,F;try{if(r.value=navigator.mediaDevices,console.error(r.value,"Navigating mediaDevice.op"),(l=r.value)!=null&&l){S.value.getUserMedia=(t=r.value.getUserMedia)!=null?t:{};for(let y of["getUserMedia","webkitGetUserMedia","mozGetUserMedia","msGetUserMedia"]){var e=(F=navigator[y])!=null?F:!1;e&&(S.value[y]=e)}}else r.value=null}catch(y){r.value=null,console.log(y,"EEEEEEEEEEEEEEEEEEEEEEEEEEEE")}return!0}async _enumNavigateDevice(){try{return await r.value.enumerateDevices().then(e=>{M.value=[];for(let l in e){let t=e[l];t.kind==="videoinput"?(f.value=t.deviceId,M.value.push(t)):(R.value=t.deviceId,C.value.push(t))}return!0})}catch{}return!0}async _openCamera(e=""){var l,t;return console.error("Navigating mediaDevice."),await h(),await this._navigateDevice(),p.value=!0,d.value="camera",(l=S.value.getUserMedia)!=null&&l?(await this._enumNavigateDevice(),g.value=e,(t=f.value)!=null&&t&&(E.value.deviceId={exact:f.value}),E.value.facingMode=_.value?"user":"environment",o.value=await r.value.getUserMedia({video:E.value,audio:b.value}),v.value.srcObject=o.value,v.value.onloadedmetadata=()=>{v.value.play()}):console.error("Navigating mediaDevice.Error"),!0}async _stopCamera(){await h();try{o.value.getTracks().forEach(e=>{e.stop(),e=!1})}catch{o.value.getVideoTracks().forEach(e=>{e.stop(),e=!1})}return v.value.src=null,!0}async _operateDevice(e){return e=="pause"?v.value.pause():e=="play"&&v.value.play(),!0}async _saveScreenShoots(){p.value=!1;try{o.value.getTracks().forEach(e=>{e.stop(),e=!1})}catch{o.value.getVideoTracks().forEach(e=>{e.stop(),e=!1})}return v.value.src=null,!0}async _screenShoot(e=!1){if(e)return s.value=[],n.value=[],!0;D.value=i.value.getContext("2d"),D.value.drawImage(v.value,0,0,i.value.width,i.value.height);try{n.value.push(i.value.toDataURL("image/png")),i.value.toBlob(l=>{s.value.push(new File([l],"fileName.png"+String(new Date),{type:"image/png"},.9))},"image/png")}catch{n.value.push(i.value.toDataURL("image/jpeg")),i.value.toBlob(l=>{s.value.push(new File([l],"fileName.jpeg"+String(new Date),{type:"image/jpeg"},.9))},"image/jpeg")}return console.log(D,"lllllllllll"),!0}async _setCameraParam(e="",l=!1){return _.value=l,f.value=e,await _openCamera()}async _setMicParam(e=""){return R.value=C.value.deviceId[e],await _openCamera()}}return{_thisMedia:r,_fileAttributeName:g,_cameraBox:p,_fileSourceFoCam:d,_fileAsSRC:n,_fileAsString:w,_fileAsRaw:s,_liveFeedSRC:i,_fileAsSRCIndex:c,_cameraDevice:j,_listCameraSource:M,_selectedCameraById:f,_selectedCameraByface:_,_liveFeedRawStreaming:v,_fileSourceFolder:U,_fileAsSRCOps:m,_fileAsSRCOpsCall:A,_fileAsSRCOpsCall2:N,_resetFileSource:h}};export{I as u};
