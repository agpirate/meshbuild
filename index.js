var xs=Object.create;var ae=Object.defineProperty;var Ms=Object.getOwnPropertyDescriptor;var Us=Object.getOwnPropertyNames;var Ws=Object.getPrototypeOf,Es=Object.prototype.hasOwnProperty;var Ts=(e,t)=>()=>(e&&(t=e(e=0)),t);var ze=(e,t)=>{for(var a in t)ae(e,a,{get:t[a],enumerable:!0})},Ge=(e,t,a,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Us(t))!Es.call(e,i)&&i!==a&&ae(e,i,{get:()=>t[i],enumerable:!(n=Ms(t,i))||n.enumerable});return e};var v=(e,t,a)=>(a=e!=null?xs(Ws(e)):{},Ge(t||!e||!e.__esModule?ae(a,"default",{value:e,enumerable:!0}):a,e)),Bs=e=>Ge(ae({},"__esModule",{value:!0}),e);var Ss={};ze(Ss,{default:()=>Pa});var bs,Pa,ws=Ts(()=>{bs=require("quasar/wrappers"),Pa=(0,bs.ssrMiddleware)(({app:e,resolve:t,render:a,serve:n})=>{e.get(t.urlPath("*"),(i,r)=>{r.setHeader("Content-Type","text/html"),a({req:i,res:r}).then(s=>{r.send(s)}).catch(s=>{s.url?s.code?r.redirect(s.code,s.url):r.redirect(s.url):s.code===404?r.status(404).send("404 | Page Not Found"):r.status(500).send("500 | Internal Server Error")})})})});var Fa={};ze(Fa,{default:()=>Da});module.exports=Bs(Fa);var L=require("path"),_s=require("vue/server-renderer"),Is=v(require("serialize-javascript")),Os=v(require("./render-template.js")),ge=v(require("./quasar.manifest.json")),ks=v(require("./server/server-entry.js"));var O=require("quasar/wrappers");var re=require("mongoose"),Je="mongodb://0.0.0.0:27017/saleit",Ve="mongodb://0.0.0.0:27017/profile",Ye="mongodb://0.0.0.0:27017/chat";console.log(`
  Connecting DBs @`,"mongodb://0.0.0.0:27017");try{I=re.mongoose.createConnection(Ve,{}),console.log("Connecting to saleitProfile DataBases....")}catch(e){console.log("Error Connecting to saleitProfile DB_"+e),process.exit(1)}var I,Ka=I.connection;I.once("open",e=>{console.log(`saleitProfile Database connected: ${Ve}`)});I.on("error",e=>{console.error(`saleitProfile DB connection error: ${e}`)});try{k=re.mongoose.createConnection(Ye,{}),console.log("Connecting to saleitProfile DataBases....")}catch(e){console.log("Error Connecting to saleitProfile DB_"+e),process.exit(1)}var k,Ha=k.connection;k.once("open",e=>{console.log(`saleitProfile Database connected: ${Ye}`)});k.on("error",e=>{console.error(`saleitProfile DB connection error: ${e}`)});try{C=re.mongoose.createConnection(Je,{}),console.log("Connecting to saleit DataBases....")}catch(e){console.log("Error Connecting to saleitProfile DB_"+e),process.exit(1)}var C,La=C.connection;C.once("open",e=>{console.log(`saleit Database connected: ${Je}`)});C.on("error",e=>{console.error(`Procurment DB connection error: ${e}`)});var ve=require("mongoose"),Ga=require("vue"),Va=ve.mongoose.Schema,Xe=ve.mongoose.Types.ObjectId;var Ze={group:{type:String,default:"client"},profile:{group:{type:String,default:"client",role:{xrole:[],clients:["likes","comment"],upgraded:["clients","likes","comment"],creatorrw:2001,creator:2001,admin:2001},enum:["upgraded","client","creator","admin","xrole"]},role:[{type:String,default:"",enum:["likes","comments","clients","*","***",""]}],capability:{type:String,default:"1010"},accstage:{type:Array,default:[]}},profileMeta:{type:String,default:"client",role:{client:["clients","likes","comments"]},enum:["upgraded","client","creator","admin"]},saleit:{group:{type:String,default:"client",role:{xrole:[],client:["likes","comments","clients"],upgraded:["clients","likes","comments"],creatorrw:2001,creator:2001,admin:2001},enum:["upgraded","client","creator","admin","xrole"]},role:[{type:String,default:"",enum:["likes","comments","clients","*","***",""]}],capability:{type:String,default:"1010"},accstage:{type:Array,default:[]}},saleitClient:{group:{type:String,default:"client",role:{xrole:[],client:["likes","comments","clients"],upgraded:["clients","likes","comments"],creatorrw:2001,creator:2001,admin:2001},enum:["upgraded","client","creator","admin","xrole"]},role:[{type:String,default:"",enum:["likes","comments","clients","*","***",""]}],capability:{type:String,default:"1010"},accstage:{type:Array,default:[]}},saleitChat:{group:{type:String,default:"client",role:{xrole:[],client:["likes","comments","clients"],upgraded:["clients","likes","comments"],creatorrw:2001,creator:2001,admin:2001},enum:["upgraded","client","creator","admin","xrole"]},role:[{type:String,default:"",enum:["likes","comments","clients","*","***",""]}],capability:{type:String,default:"1010"},accstage:{type:Array,default:[]}},publicChat:{group:{type:String,default:"client",role:{xrole:[],client:["likes","comments","clients"],upgraded:["clients","likes","comments"],creatorrw:2001,creator:2001,admin:2001},enum:["upgraded","client","creator","admin","xrole"]},role:[{type:String,default:"",enum:["likes","comments","clients","*","***",""]}],capability:{type:String,default:"1010"},accstage:{type:Array,default:[]}}};var qe={_stage_:{type:Number,default:1,$ifNull:1},profile:{type:Array,default:["/saleitgr/saleitpng.png"],$ifNull:["/saleitgr/saleitpng.png"],vtype:"file"},cover:{type:String,default:"/saleitgr/saleitpng.png",$ifNull:"/saleitgr/saleitpng.png",vtype:"file"},profileMeta:{type:Array,default:[{mimetype:"",encoding:"",originalname:"",destination:"",fieldname:"",filename:"",size:"",path:"",geoLocation:""}],ifNull:[{mimetype:"",encoding:"",originalname:"",destination:"",fieldname:"",filename:"",size:"",path:"",geoLocation:""}]},userName:{type:String,Vtype:"String",default:"",$ifNull:""},name:{type:String,Vtype:"String",default:"",$ifNull:"",validRuleset:"[ val => val && val.length > 0 || 'Please type something']"},lastName:{type:String,Vtype:"String",default:"",$ifNull:""},password:{type:String,vtype:"String",default:0,$ifNull:0},enrollKey:{type:String,vtype:"String",default:"",$ifNull:""},phone:{type:Number,vtype:"Number",default:0,$ifNull:0,required:!0,index:{unique:!0,dropDups:!0,length:10}},phoneCode:{type:Array,vtype:"Array",default:["",""],$ifNull:["",""],required:!0},location:{country:{type:String,default:"",$ifNull:""},provinance:{type:String,default:"",$ifNull:""},city:{type:String,default:"",$ifNull:""},street:{type:String,default:"",$ifNull:""}},geolocation:{lat:{type:Number,vtype:"Number",default:0,$ifNull:0},long:{type:Number,vtype:"Number",default:0,$ifNull:0}},verified:{type:String,Vtype:"String",default:"0",$ifNull:"",enum:["0","1"]},cart:{type:Array,Vtype:"Array",default:[],$ifNull:[]},contacts:{type:Array,vtype:"Array",default:[],$ifNull:[],index:{length:10}},queryWeight:{1:{type:Array,Vtype:"Array",default:[1,50,50,50],$ifNull:[1,50,50,50]},2:{type:String,Vtype:"String",default:"1.1.1.1",$ifNull:"1.1.1.1"},3:{type:String,Vtype:"String",default:"1.1.1.1",$ifNull:"1.1.1.1"}},acckey:{type:Xe,ref:"threeas"},acckey2:{type:Xe,ref:"threeas"}},Qe={userID:{type:String,default:""},location:{type:String,default:""},activities:{name:{type:String,default:""},amount:{type:Number,vtype:"Number",default:0}},interests:{type:String,default:""}};function S(e){var t=new Date-new Date(e),a=Math.floor(t/(1e3*60*60*24));if(a)return new Date(e).toLocaleString();var n=Math.floor(t/(1e3*60*60)),i=Math.floor(t/(1e3*60));return n%=24,i%=60,(n?n+" H,  ":"")+(i?i+" M ago":n?"":"just now")}var tt=require("mongoose"),be=tt.mongoose.Schema,Se=(e=null)=>new Date(e).toLocaleString(),st=new be(Ze,{timestamps:Se});st.method("toJSON",function(){let{__v:e,_id:t,...a}=this.toObject();return a.id=t,a});var at=new be(qe,{timestamps:Se});at.method("toJSON",function(){let{__v:e,_id:t,...a}=this.toObject();return a.id=t,a.fupdatedAt=S(a.updatedAt),a});var rt=new be(Qe,{timestamps:Se});rt.method("toJSON",function(){let{__v:e,_id:t,...a}=this.toObject();return a.id=t,a.fupdatedAt=S(a.updatedAt),a});var y;I.models.threeas??!1?console.log("Collections alread existed on"):(y=I.model("threeas",st),console.log(y,"New Created !"));var h;I.model.profileModel?console.log("assets Collections already existed on Procurment"):(h=I.model("profiles",at),console.log(h,"New Created !"));var et;I.model.profileMetaModel?console.log("assets Collections already existed on Procurment"):(et=I.model("profileMetas",rt),console.log(et,"New Created !"));var nt=require("mongoose");ObjectId=nt.mongoose.Types.ObjectId;var Ds=require("jsonwebtoken");async function Fs(e,t,a){console.log(`

 Authentication Middlewares =========> Entering 
`);let n=e.cookies??!1,i=n?n?.access_token??!1:!1;console.log(`Cookies Finding ; Option 1 : Cookies = ${i} 
`);var r=e.headers??!1;if(typeof r=="string"){let p=r;try{r=JSON.parse(p)}catch{}}let s=r.authorization??!1,l=r.cookie??!1;if(!i){let p="";s?(s=s.split(" ")??null,p=s.length<2?null:s[1],console.log(`Cookies Finding ; Option 2 : autorization Header-Cookies = ${p} 
`)):(p=l?l.replace("access_token= ",""):"",console.log(`Cookies Finding ; Option 2 : cookie Header-Cookies = ${l} 
`)),i=p?.trim()??i}if(!i)return console.log(`Cookies Finding Error ; No Cookie Founded : Exit!
`),t.status(401).send("Access forbidden ? _cookies failed");console.log(`Cookies Finding Final Passed ;  = ${i} 
`);let o=null;var u=r?.acckey??null,c=r?._iss??null,f=r?._issmodal??null,d=r?.acckey??null;try{let p=Ds.verify(i,"itserviceKey");console.log(`Token Decoded For = 
`),console.log(p),p&&(o=p.userID??o,u=p.acckey??u)}catch{console.log(`Token Decoded Error = 
`)}if(o)await h.findOne({_id:new ObjectId(o)}).then(p=>{if(p)u=p.acckey??!1,d=p.queryWeight??!1;else return t.status(403).send("userID ; Access forbidden")}).catch(()=>t.status(403).send("userID ; Access forbidden"));else return t.status(401).send("Access forbidden ? userID failed");try{c=null,f=f??"saleit",console.log(`== Role & Permission Acckey ${u?"is OK":"No"} && Target Modal is = ${f??"No Model_Specified"}  
`),u&&f&&await y.findOne({_id:new ObjectId(u)}).then(p=>(p&&(c=p[f]??null),!0)).catch(()=>!0),console.log(`== Role & Permission  = Null for Modal = ${f??"No Model ?"} && ${c} 
`)}catch(p){return console.log(p),!0}return c?(e.userID=o,e.issId=u,e.issrole=c,e.queryWeight=d,e.params.lat=r.lat??"",e.params.long=r.long??"",e.location={lat:r.lat??"",long:r.long??""},console.log(`Ending MWare UserID = ${o} && Acckey = ${u} 
`),a(),!0):t.status(403).send("UserRole ; Access forbidden")}var g=Fs;var ot=require("mongoose"),ut=v(require("jsonwebtoken")),ct=require("express"),it=ot.mongoose.Types.ObjectId,dt=(0,ct.Router)(),As={"Content-Type":"application/json","Content-Length":"5000",ETag:"Roaw"},lt=["id"];var ne=["phone","id"];dt.post("/login",async(e,t)=>{let a=e.body??{},n=Object.keys(a),i=ne.every(s=>new Set(n).has(s));if(!n.length&&!i)return t.status(404).send("createKey","is Null");let r={};for(let s in ne){let l=ne[s],o=a[l]??!1;if(console.log(l,`
`,ne,lt.includes(l),o),o)if(lt.includes(l))try{r._id=new it(o)}catch{}else r[l]=(l=="phone"&&o.length==10,o)}delete r.phoneCode,console.log(r,`findbyyyyyy

`,a);try{return await h.findOne(r).then(async s=>{if(console.log(`

 User Authentication Profile == ${s??null},, for userID = 
`),console.log(r),s&&Object.keys(s).length){console.log(`
 User Acckey  == ${s.acckey??!1}  <= ${s.acckey??!1?"Yes":"No"} < == >User Already Existed ?
`);let l=new it(s.acckey);return await y.findOne({_id:l}).then(o=>{if(console.log(`
 Checked :_ User Acckey / ID == ${o?.id??!1}  <= < == >User Already Existed ?
`),o){s=s.toObject()??!1;var u=null;try{u=ut.default.sign({id:s._id,userID:s._id,acckey:o.id},"itserviceKey",{expiresIn:"1d"})}catch{}if(!u)return t.status(501).json({data:"Token Generating Error"});let c=24*60*60*1e3;return t.setHeader("authorization",`Bearer ${u}`),t.cookie("access_token",u,{maxAge:864e5,httpOnly:!0,domain:e.hostname,secure:!1,signed:!1,sameSite:"lax"}),t.setHeader("acctype",JSON.stringify(o)),t.setHeader("token",u),t.setHeader("role",o.profile.group??null),s.acctype=o,s.id=s._id,console.log(e.hostname,`
 Final Checked :  == ${s.id??!1}  <= < == >User Authenticated ? with token 
 ${u}`),t.set(As),t.status(200).send(s)}return t.status(501).json(o)}).catch(o=>(console.log(`
 ${o}`),t.status(501).send(o)))}else return t.status(202).send(s)}).catch(s=>t.status(404).send(s))}catch(s){return t.status(505).send(s)}});var ft=dt;var pt=require("mongoose"),Ks=require("jsonwebtoken");ObjectId=pt.mongoose.Types.ObjectId;async function Hs(e,t,a){var n=e.cookies??e.headers.cookie??!1,i=e.headers??!1;let r=n?.access_token??!1;if(typeof i=="string"){let d=i;try{i=JSON.parse(d)}catch{}}let s=i.authorization??!1;if(s&&(r=s.split('"')[1]?.trim()??r),!(r&&i))return t.status(403).send("Access forbidden");let l=i.id??null;var o=i?.acckey??null,u=i?._iss??null,c=i?._issmodal??null,f=i?.acckey??null;try{let d=Ks.verify(r,"itserviceKey");(!l||d)&&(l=d.userId??l,o=d.acckey??o),console.log(l,"bearToken-------------->")}catch{}if(l)await h.findOne({_id:new ObjectId(l)}).then(d=>{if(d)o=d.acckey??!1,f=d.queryWeight??!1;else return t.status(403).send("Access forbidden")}).catch(()=>t.status(403).send("Access forbidden"));else return t.status(403).send("Access forbidden");return e.userId=l,e.issId=o,e.issrole=u,e.queryWeight=f,o&&c?await y.findOne({_id:new ObjectId(o)}).then(d=>(d?u=d[c]:u=null,!0)).catch(()=>!0):(u=null,e._issrole=u,a(),!0)}var gt=Hs;var vt=require("mongoose"),bt=v(require("jsonwebtoken")),St=require("express");var w=async function(e,t=[],a={},n=100,i={createdAt:-1},r=0){try{return await e.find({$or:t},a).sort(i).skip(Number(r)).limit(Number(n)).then(s=>(console.log(s.length,"or Fetching..","skips =",r,"limits =",n,"sortBy =",i),s?{status:200,data:s}:{status:200,data:s})).catch(s=>({status:501,data:s}))}catch(s){return{status:500,data:s}}},b=async function(e,t=[],a={},n=100,i={createdAt:-1},r=0){try{return await e.find({$and:t},a).sort(i).skip(Number(r)).limit(Number(n)).then(s=>(console.log(s.length,"and& Fetching..","skips =",r,"limits =",n,"sortBy =",i),s?{status:200,data:s}:{status:200,data:s})).catch(s=>({status:501,data:s}))}catch(s){return{status:500,data:s}}},U=async function(e,t=[],a={},n=100,i={createdAt:-1}){try{return await e.find({$or:t},a).sort(i).limit(n).then(r=>(console.log(r.length,"Or Fetching"),r?{status:200,data:r}:{status:200,data:r})).catch(r=>({status:501,data:r}))}catch(r){return{status:500,data:r}}},$=async function(e,t){try{return await e.findByIdAndDelete(t).then(a=>a&&Object.keys(a).length?{status:200,data:a}:{status:200,data:null}).catch(a=>({status:501,data:a}))}catch(a){return{status:500,data:a}}};var yt=require("mongoose"),we=yt.mongoose.Types.ObjectId;var Ls=["id","Id","ID"],zs=["saleitID","userID"];var Gs=["geoSearch","queryOperator","returnWat","limits","skips","sortBy","upload","timestamp","latest","lat","long","paginationID"];async function m(e={}){if(!e)return[!1,!1,!1,!1,!1];var t={};let a=[],n=e.limits??0,i=e.skips??0,r=e.sortBy??{createdAt:-1};return console.log(`
 Incoming Query 
`,e),[Object.keys(e).length?await Js(e):[{}],a,n,r,i]}var ie=3;async function Js(e={}){let t=[];console.log(`
 Incoming Cleared Query 
`,e);let a=e.geoSearch??"off",n=(e.queryOperator??"-or").split("-");for(let r in e){let s=r;var i=e[r]??"";if(Gs.includes(r))continue;try{i=isNaN(Number(i))?i:Number(i)}catch{}let l={};if(s=="qweight"){let o=parseInt(i[1]),u=parseInt(i[2]);console.log(`
 `,n[0]),n[0]=="productSpecific"?t=[{catagoryScore:o==0?{$gte:0}:o},{usageScore:u==0?{$gte:0}:u}]:n[0]=="userSpecific"?t=[{catagoryScore:{$gte:o-o/ie,$lte:o+o/ie}},{usageScore:{$gte:u-u/ie,$lte:u+u/ie}}]:i.length==5&&(t=[{catagoryScore:{$gte:0}},{usageScore:{$gte:0}}],t.push({trendScore:{$lte:1e4}}));break}else if(Ls.includes(r))try{l._id=new we(i)}catch{}else if(zs.includes(r))try{l[r]=new we(e[r]??"")}catch{}else l[r]=typeof i=="string"?{$regex:i,$options:"i"}:i;t.push(l)}if(e.paginationID??!1)try{t.push({_id:{$gt:new we(e.paginationID)}})}catch{console.log(`
 Error Formating Pagination ID ...`)}if(a!="off"){let s={nearMe:7,myCity:5,myCountry:0,off:0}[a];t.push({$expr:{$regexMatch:{input:{$toString:"$geolocation.long"},regex:"^"+String(e.long).slice(0,s)}}}),t.push({$expr:{$regexMatch:{input:{$toString:"$geolocation.lat"},regex:"^"+String(e.lat).slice(0,s)}}})}return t.length?t=t.filter(r=>Object.keys(r).length):t=[{}],console.log(`
Yield Query 
`,t),t}var le={};async function Ne(e,t,a=!1,n=!1){console.log(`
============= Document Update ============= updateKey =`+a+" <<START>>"),le={};for(let i in t)try{let r=t[i],s={};a??!1?s[a]=r[a]??null:s={updatedAt:null},await e.findOne(s).then(async l=>{if(l==null)l=new e(r),console.log("Creating Document =",l.updateKey??"",s," ;;Newly Creating Process Debug",l);else{if(!a)return!1;l=Object.assign(l,r),console.log("Updating Document =",l.updateKey??"",s,`;
 Incoming AccKey =`,l)}return await l.save().then(o=>(console.log("Final Acckey =",o.acckey??o._id,""),o=o.toObject()??!1,o&&Object.keys(o).length?(a&&(le[s[a]]=o),console.log(`
============= Document Update ============ END Success `+i),{status:200,data:le}):{status:501,data:o})).catch(o=>(console.log(o,"Creating Process Debug Error"),{status:500,data:o}))}).catch(l=>({status:500,data:l}))}catch(r){return{status:500,data:r}}return{status:200,data:le}}var Vs=[{group:"client",saleit:{group:"client",role:["likes","comments","clients"],capability:"02220",accstage:[1,3,4,5]},profile:{group:"client",role:[""],capability:"22220",accstage:[1,3,4,5]},profileMeta:"client",saleitClient:{group:"client",role:[""],capability:"22220",accstage:[1,3,4,5]},saleitChat:{group:"client",role:[""],capability:"22220",accstage:[1,3,8]},publicChat:{group:"client",role:[""],capability:"22220",accstage:[1,3,8]}},{group:"upgraded",profile:{group:"upgraded",role:[""],capability:"22220",accstage:[1,3,4,5]},profileMeta:"upgraded",saleitClient:{group:"upgraded",role:[""],capability:"22220",accstage:[1,3,4,5]},saleitChat:{group:"upgraded",role:[""],capability:"22220",accstage:[1,3,8]},publicChat:{group:"upgraded",role:[""],capability:"22220",accstage:[1,3,8]}},{group:"creator",saleit:{group:"creator",role:[""],capability:"22220",accstage:[1,2,3,4,5]},profile:{group:"creator",role:[""],capability:"22220",accstage:[1,3,4,5]},profileMeta:"creator",saleitClient:{group:"creator",role:[""],capability:"22220",accstage:[1,2,3,4,5]},saleitChat:{group:"creator",role:[""],capability:"22220",accstage:[1,3,8]},publicChat:{group:"creator",role:[""],capability:"22220",accstage:[1,3,8]}},{group:"admin",saleit:{group:"admin",role:[""],capability:"22220",accstage:[1,2,3,4,5]},profile:{group:"admin",role:[""],capability:"22220",accstage:[1,3,4,5]},profileMeta:"admin",saleitClient:{group:"admin",role:[""],capability:"22220",accstage:[1,3,8]},saleitChat:{group:"admin",role:[""],capability:"22220",accstage:[1,3,8]},publicChat:{group:"admin",role:[""],capability:"22220",accstage:[1,3,2,3]}}],Ys="group",mt="creator",Xs="phone";async function ht(){return console.log(`

-==--------------------------------Role & Permissions Managment---------------START`),await Ne(y,Vs,Ys).then(async e=>{console.log(`
`+Object.keys(e.data),` = Sum of Role and Permissions <=>
`);for(let i in e.data)console.log(`
 Role Name = ${i} && acckey = ${e.data[i]._id}
`);let t=null;if(e.status==200)t=e.data[mt]??!1;else return!0;console.log(`
 Creating Sample User = ${mt} && with accKey ${t._id??null}`);let a=[{name:"root",lastName:"root",phone:"123456787",acckey:t?new ObjectId(t._id):null}],n=await Ne(h,a,Xs);return console.log(`User Creating  ====>> ${n.status==200?"success":"Error"}`),console.log(`---------------------------------Role & Permissions Managment---------------END

`),!0})}var Zs=vt.mongoose.Types.ObjectId;ht();var W=(0,St.Router)(),Ie=y,oe="/permission",ue={"Content-Type":"application/json","Content-Length":"5050",ETag:"Roaw","Set-Cookie":["type=ninja","language=javascript"]},_e="phone";W.post("/add",gt,async(e,t)=>{let a={},n=e.body??{};if(n[_e]??!1)a[_e]=n[_e]??!1;else return t.status(303).send("req.body is null");let i=await y.findOne({group:n.upgrade??"creator"});if(i)modelQA.acckey=i._id;else return{status:303,data:"Permission Assign Error"};try{return await h.findOne(a).then(async r=>{if(r&&Object.keys(r).length){let s=new Zs(r.acckey);return await y.findOne({_id:s}).then(l=>{if(l){let o=bt.default.sign({userID:r.id,acckey:l.id},"itserviceKey",{expiresIn:"1h"});return t.setHeader("Authorization",`Bearer ${o}`),t.cookie("access_token",o,{maxAge:9e5,httpOnly:!0,secure:!1,signed:!1}),t.setHeader("threea",JSON.stringify(l)),t.setHeader("token",JSON.stringify(o)),t.setHeader("role",l.profile.group),t.status(200).send(JSON.stringify(r))}return t.status(404).json("Permission Error")}).catch(()=>t.status(404).json({}))}else return t.status(202).send(null)}).catch(r=>t.status(404).send(r))}catch(r){return t.status(505).send(r)}});var qs="group";W.put(oe,g,async(e,t)=>{let[a,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1];if(!n)return t.status(404).send({message:"NullData(P +token) Received."});let r={};return r=e.body??{},Object.keys(r).length==0&&(r[qs]??!0)?t.status(404).send(""):(r.userID=n,documentCupdate(y,[r],"group").then(s=>(t.set(ue),t.status(s.status).send(s.data))))});W.get(oe+"s",g,async(e,t)=>{let[a,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1],r=e.query??e.params??{};Object.keys(r).length==0;let[s={},l=[],o=100]=await m(r);try{let u=await w(Ie,s,l,o);return u.status==200?(t.set(ue),t.status(u.status).send(u.data)):t.status(404).send("(Srv):- _read303;but, "+u.data)}catch{return t.status(505).send("(Srv);- _read505")}});W.get(oe,g,async(e,t)=>{let[a,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1],r=e.query??e.params??{};Object.keys(r).length==0;let[s={},l=[],o=100]=await m(r);try{let u=await b(Ie,s,l,o);return u.status==200?(t.set(ue),t.status(u.status).send(u.data)):t.status(404).send("(Srv):- _readf202;but, "+u.data)}catch{return t.status(505).send("(Srv);- _readf505")}});W.delete(oe,g,async(e,t)=>{let[a,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1];if(!n)return t.status(404).send({message:"NullData(P) Received."});let r=e.query??e.params??{};Object.keys(r).length==0;try{let s=await $(Ie,r.id);return s.status==200?(t.set(ue),t.status(s.status).send(s.data)):t.status(404).send("(Srv):- _del202;but, "+s.data)}catch{return t.status(505).send("(Srv);- _del505")}});var wt=W;var kt=require("express"),z=v(require("multer")),Ct=require("mongoose");var Nr=require("multer");async function E(e){let t={};for(let s in e){t[s]=[],t[s+"Meta"]=[];var a=e[s];for(let l in a)try{var n=a[l],i="/"+n.fieldname+"/"+n.filename,r={thefilePath:i,geoLocation:"0000000000xyz"};t[s][l]=r.thefilePath,t[s+"Meta"][l]=r}catch{return!1}}return t}async function Nt(e){let t={};var a={thefilePath:"/"+e.fieldname+"/"+e.filename,geoLocation:"0000000000xyz"};return t[e.fieldname]=a.thefilePath,t[e.fieldname+"Meta"]=a,t}var _t=Ct.mongoose.Types.ObjectId,B=(0,kt.Router)(),R=h,G="/profile",T={"Content-Type":"application/json","Content-Length":"5050",ETag:"Roaw","Set-Cookie":["type=ninja","language=javascript"]};var It={"application/pdf":"pdf","application/zip":"zip","text/csv":"csv","text/pdf":"pdf","text/json":"json","image/jpeg":"jpeg","image/png":"png","image/svg+xml":"svg+xml","image/webp":"webp","video/mp4":"mp4","video/mkv":"mkv"},Ce=()=>{var e="";return{storage:z.default.diskStorage({filename:(t,a,n)=>{let i=It[a.mimetype];e=a.originalname.split(".")[0].split(" ")[0]+"-"+new Date().getTime()+"."+i,n(null,e)},destination:(t,a,n)=>{n(null,"./public/"+a.fieldname)},path:(t,a,n)=>{n(null,"/"+a.fieldname+"/"+e)}}),limits:{fileSize:1e6*5},fileFilter:(t,a,n)=>{if(It[a.mimetype])n(null,!0);else return n(null,!1)}}},Qs={updatedAt:null},ce="phone",Oe="id";B.post(G,async(e,t)=>{let[a,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1],r=e.query?e.query:e.params;var s=r?.file_??!1;let l={};console.log(`
<==> Profile API Creating New User == Parameters => ${r}`);try{if(s)(s.files??!1)&&(0,z.default)(Ce()).fields([{name:s.files,maxCount:4}])(e,t,async o=>{if(l=e.body??{},o)return t.status(303).send({message:"Uploading Error"+o});{let u=e.files??!1;if(u){let c=await E(u);l[s.files]=c[s.files]}}return l.userID=n,await Ot(l).then(u=>t.status(u.status).send(u.data))});else return l=e.body??{},(l[ce]??null)==null?t.status(404).send(""):(l.userID=n,await Ot(l).then(o=>(console.log(`
Creating Status == ${o.data}

`,l),t.set(T),t.status(o.status).send(o.data))))}catch(o){return t.status(401).send(o)}});B.put(G,g,async(e,t)=>{let[a,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1];if(!n)return t.status(404).send({message:"NullData(P +token) Received."});var s=(e.query?e.query:e.params)?.file_??!1;let l={};try{if(s)s.files??!1?(0,z.default)(Ce()).fields([{name:s.files,maxCount:4}])(e,t,async o=>{if(l=e.body??{},o??!1)return t.status(303).send({message:"Uploading Error"+o});{let u=e.files??!1;if(console.log(`
(Multiple) File Existed as `,u,o),u){let c=await E(u);l[s.files]=c[s.files]}else return t.status(303).send({message:"Uploading Error"})}return(l[Oe]??null)==null?t.status(404).send(""):(l.userID=n,await ke(l).then(u=>(t.set(T),t.status(u.status).send(u.data))))}):(s.file??!1)&&(0,z.default)(Ce()).single(s.file)(e,t,async o=>{if(l=e.body??{},o??!1)return t.status(303).send({message:"Uploading Error"+o});{let u=e.file??!1;if(console.log(`
(Single) File Existed as `,u,o),u){let c=await Nt(u);l[s.file]=c[s.file]}else return t.status(303).send({message:"Uploading Error"})}return(l[Oe]??null)==null?t.status(404).send(""):(l.userID=n,await ke(l).then(u=>(t.set(T),t.status(u.status).send(u.data))))});else return l=e.body??{},(l[Oe]??null)==null?t.status(404).send(""):(l.userID=n,await ke(l,"UpdateRowItem",l.onplaySubops??!1).then(o=>(t.set(T),t.status(o.status).send(o.data))))}catch(o){return t.status(401).send(o)}});B.get(G+"s",g,async(e,t)=>{let[a,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1],r=e.query??e.params,[s={},l=[],o=100,u={createdAt:-1},c=0]=await m(r);if(!Object.keys(s).length)return t.status(404).send({message:"NullData(P) Received."});let f=(r.queryOperator??"-or").split("-");try{let d=f[1]=="and"?await b(R,s,l,o,u):await w(R,s,l,o,u);return d.status==200?t.status(d.status).send(d.data):t.status(404).send("(Srv):- _read303;but, "+d.data)}catch{return t.status(505).send("(Srv);- _read505")}});B.get(G,g,async(e,t)=>{let[a,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1],r=e.query??e.params,[s={},l=[],o=100,u={createdAt:-1},c=0]=await m(r);if(!Object.keys(s).length)return t.status(404).send({message:"NullData(P) Received."});let f=(r.queryOperator??"-or").split("-");try{let d=f[1]=="and"?await b(R,s,l,o,u):await U(R,s,l,o,u);return d.status==200?(t.set(T),t.send(d.data)):t.status(404).send("(Srv):- _readf202;but, "+d.data)}catch{return t.status(505).send("(Srv);- _readf505")}});B.delete(G,g,async(e,t)=>{let[a,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1];if(!n)return t.status(404).send({message:"NullData(P) Received."});let r=e.query??e.params;if(!(r??!1)||Object.keys(r).length==0)return t.status(404).send("NullData(P) Received.");try{let s=await $(R,r.id);return s.status==200?(t.set(T),t.send(s.data)):t.status(404).send("(Srv):- _del202;but, "+s.data)}catch{return t.status(505).send("(Srv);- _del505")}});var jt=B;async function Ot(e){try{let t={};return e[ce]??!1?t[ce]=e[ce]:t=Qs,console.log(`
<==>CreateContent Profile Service 0=> Check Existances of Params 
`),await R.findOne(t).then(async a=>{a==null?(a=new R(e),console.log(`
 == New User Profile Created !
`)):(a=Object.assign(a,e),console.log(`
 == Exising User --> Updating User Profile With Incoming Data !
`));let n=e.group??"client",i="";console.log(`
 == Assing Role & Permission !
`);try{i=await y.findOne({group:n}),console.log(`
 == Role & Permission Acckey = ${i._id??null} == ${n}!
`)}catch(r){n=r}if(i)a.acckey=i._id;else return{status:303,data:"Permission Assign Error"};return a.phone.length==10&&(a.phone=a.phone.slice(1,9)),console.log(`oooooooooooooo
`,a.phone,"pppppppppp"),await a.save().then(r=>r&&Object.keys(r).length?{status:200,data:r}:{status:303,data:r}).catch(r=>({status:303,data:r}))}).catch(a=>({status:303,data:a}))}catch{return{status:303,data:"Fatal DATABASE ERROR"}}}var ea="id";async function ke(e,t=null,a=null){console.log(`

 Updating Profile 
`);try{let n={};if(e.id??!1)n._id=new _t(e[ea]);else return{status:303,data:"body.null data"};return console.log(`
<==>UpdatingContent Profile Service 0=> Check Existances of Params 
`),console.log(n),await R.findOne(n).then(async i=>{if(console.log(`
<==> Acckey = ${i.acckey??" No User"} && subOps = ${a} 
`),i==null)return{status:303,data:"Record Doesn't Found."};if(a=="updateRole"&&(e.group??!1)){console.log(`
 == Updating Role & Permission New Group = ${e.group??!1}`);let r=await y.findOne({group:e.group});r?(console.log(`
 == Profile Role Updating  acckey = ${r.id??null} && RoleGroup =${e.group}`),i=Object.assign(i,{acckey:new _t(r.id)})):console.log(`
 == Updating Role & Permission ;- Creating New Group = ${e.group??!1} ; Failed`)}else i=Object.assign(i,e);return await i.save().then(r=>r&&Object.keys(r).length?{status:200,data:r}:{status:303,data:r}).catch(r=>({status:303,data:r}))}).catch(i=>({status:303,data:i}))}catch{return{status:303,data:"Fatal DATABASE ERROR"}}}var $t=require("mongoose"),Ur=require("vue"),ta=$t.mongoose.Schema,je=ta.ObjectId;var Rt={userID:{type:je,ref:"profiles"},content:{type:String,default:""},phone:{type:String,default:0}},Pt={comment:{type:String,vtype:"String",default:"",$ifNull:""},saleitID:{type:je,ref:"saleits"},userID:{type:je,ref:"profiles"},userName:{type:String,vtype:"String",default:"",$ifNull:""},phone:{type:Number,vtype:"Number",default:"",$ifNull:""}};var xt=require("mongoose"),$e=xt.mongoose.Schema,Fr=$e.ObjectId,Mt=(e=null)=>new Date(e).toLocaleString(),Ut=new $e(Rt,{timestamps:Mt});Ut.method("toJSON",function(){let{__v:e,_id:t,...a}=this.toObject();return a.id=t,a.fupdatedAt=S(a.updatedAt),a.fcreatedAt=S(a.createdAt),a});var Wt=new $e(Pt,{timestamps:Mt});Wt.method("toJSON",function(){let{__v:e,_id:t,...a}=this.toObject();return a.id=t,a.fupdatedAt=S(a.updatedAt),a.fcreatedAt=S(a.createdAt),a});var Re;k.model.publicChatModel?console.log("assets Collections already existed on Procurment"):Re=k.model("publicChats",Ut);var J;k.model.saleChatModel?console.log("sale it Collections already existed on saleit content"):J=k.model("contentChats",Wt);var Jt=require("mongoose"),Vt=require("express"),dn=require("multer");var xe=require("mongoose");var Kr=xe.mongoose.Schema,Pe=xe.mongoose.Types.ObjectId,Et={_stage_:{type:Number,vtype:"Number",default:1},userID:{type:Pe,ref:"profiles"},userName:{type:String,vtype:"String",default:"",$ifNull:""},phone:{type:Number,vtype:"Number",default:"",$ifNull:""},phoneCode:{type:Array,vtype:"Array",default:["",""],$ifNull:["",""],required:!0},catagory:{type:String,vtype:"String",default:"Households",$ifNull:"Households",enum:["Electronics","Vehicles","Households","Land/House","Clothing","Food","Others"]},queryWeight:{type:String,vtype:"String",default:"1.1.1.1",$ifNull:"1.1.1.1"},catagoryScore:{type:Number,vtype:"Number",default:0,$ifNull:0},usageScore:{type:Number,vtype:"Number",default:0,$ifNull:0},trendScore:{type:Number,vtype:"Number",default:0,$ifNull:0},usage:{type:String,vtype:"String",default:"Used",$ifNull:"Used",enum:["New","Used","Others"]},saleitgr:{type:Array,default:["/saleitgr/saleitpng.png"],vtype:"file"},header:{type:String,vtype:"String",default:"....",$ifNull:"....",validRuleset:"[ val => val && val.length > 0 || 'Please type something']"},content:{type:String,vtype:"String",textarea:!0,default:"....",$ifNull:"...."},quantity:{type:Number,vtype:"Number",default:0,$ifNull:0},price:{type:Number,vtype:"Number",default:0,$ifNull:0},currency:{type:String,vtype:"String",default:"$(US)",$ifNull:"$(US)",enum:["$(US)","GB Pound","Euro","ETB","Pound",""]},discount:{type:Number,vtype:"Number",default:0,$ifNull:0},tPrice:{type:Number,vtype:"Number",default:0,$ifNull:0},location:{country:{type:String,default:"",$ifNull:""},provinance:{type:String,default:"",$ifNull:""},city:{type:String,default:"",$ifNull:""},street:{type:String,default:"",$ifNull:""}},geolocation:{lat:{type:Number,vtype:"Number",default:0,$ifNull:0},long:{type:Number,vtype:"Number",default:0,$ifNull:0}},timer:{action:{type:String,vtype:"String",enum:["delete","expired","sold",""],default:"",$ifNull:""},hours:{type:Number,vtype:"Number",default:-1,$ifNull:-1},days:{type:Number,vtype:"Number",default:-1,$ifNull:-1}},status:{type:String,vtype:"String",default:"posted",$ifNull:"posted",enum:["posted","sold","Paused","discarded"]},likes:{like:{type:Number,vtype:"Number",default:0,$ifNull:0},dislike:{type:Number,vtype:"Number",default:0,$ifNull:0}},completed:{type:String,vtype:"String",default:"no",$ifNull:"no"},_itServiceRating:{type:Number,vtype:"Number",default:0,$ifNull:0},tClient:{type:Number,vtype:"Number",default:0,$ifNull:0},tQs:{type:Number,vtype:"Number",default:0,$ifNull:0},tQ:{type:Number,vtype:"Number",default:0,$ifNull:0},tC:{type:Number,vtype:"Number",default:0,$ifNull:0},tQC:{type:Number,vtype:"Number",default:0,$ifNull:0},tQt:{type:Number,vtype:"Number",default:0,$ifNull:0},tCt:{type:Number,vtype:"Number",default:0,$ifNull:0},tQCt:{type:Number,vtype:"Number",default:0,$ifNull:0},tQCtonD:{type:Number,vtype:"Number",default:0,$ifNull:0},tQCttech:{type:Number,vtype:"Number",default:0,$ifNull:0}},Tt={geolocation:{lat:{type:String,vtype:"String",default:"000000",$ifNull:"000000"},long:{type:String,vtype:"String",default:"000001",$ifNull:"000001"}},location:{country:{type:String,default:"",$ifNull:""},provinance:{type:String,default:"",$ifNull:""},city:{type:String,default:"",$ifNull:""},street:{type:String,default:"",$ifNull:""}},phone:{type:Number,vtype:"Number",default:"",$ifNull:""},phoneCode:{type:Array,vtype:"Array",default:["",""],$ifNull:["",""],required:!0},saleitID:{type:Pe,ref:"saleits"},userID:{type:Pe,ref:"profiles"},orderID:{type:String,vtype:"String",default:"xyxy",$ifNull:"+xyxy"},confirmID:{type:String,vtype:"String",default:"xyxy",$ifNull:"+xyxy"},quantity:{type:Number,vtype:"Number",default:0,$ifNull:0},price:{type:Number,vtype:"Number",default:0,$ifNull:0},currency:{type:String,vtype:"String",default:"$(US)",$ifNull:"$(US)",enum:["$(US)","GB Pound","Euro","ETB","Pound",""]},paymentMethod:{type:String,vtype:"String",default:"onDelivery",$ifNull:"onDelivery",enum:["onDelivery","TELBirr","EBCBirr","others",""]},served:{type:String,vtype:"String",default:"Requested",$ifNull:"Requested",enum:["Served","Queed","Requested","Requesting"]},store:{type:String,vtype:"String",default:"cart",$ifNull:"cart",enum:["cart","buy","bought"]},description:{type:String,vtype:"String",default:"",$ifNull:""}};var Me=require("mongoose"),Bt=Me.mongoose.Schema;Me.mongoose.set("strictQuery",!0);var Dt=(e=null)=>new Date(e).toLocaleString(),Ft=new Bt(Et,{timestamps:Dt});Ft.method("toJSON",function(){let{__v:e,_id:t,...a}=this.toObject();a.id=t,a.fupdatedAt=S(a.updatedAt),a.fcreatedAt=S(a.createdAt);let n=String(a.phone);return a.fphone=n.slice(0,3)+"****"+n[7]+n[8],a.netPrice=(a.discount??0)||(a.price??0),a.isOpen=(a.netPrice??0)*(a.quantity??0),a});var At=new Bt(Tt,{timestamps:Dt});At.method("toJSON",function(){let{__v:e,_id:t,...a}=this.toObject();a.id=t,a.fupdatedAt=S(a.updatedAt),a.fcreatedAt=S(a.createdAt);let n=String(a.phone);return a.fphone=n.slice(0,3)+"****"+n[7]+n[8],a});var j;C.model.saleitModel?console.log("sale it Collections already existed on saleit content"):(j=C.model("sales",Ft),console.log(j,"New Created !"));var M;C.model.saleitClientModel?console.log("sale it Collections already existed on saleit content"):(M=C.model("saleitClients",At),console.log(M,"New Created !"));var Ht=require("mongoose"),Qr=require("express");ObjectId=Ht.mongoose.Types.ObjectId;var sa={Households:5,Clothing:20,Food:35,Electronics:50,Vehicles:65,"Land/House":80,Others:100},aa={New:100,Used:75,All:1};var Ue={updatedAt:null},P=class{constructor(t,a){console.log(`
_user_Und_foreign_Operations Init 
 With User++currentModel =`,t,` & Data of UserID= 
`,a.userID??!1),this.reqData=a,this.model=t||"",this.userID=null,this.modalId=null,this.createNew=!0}async addFollowing(){this.userID=this.reqData.userID?{_id:new ObjectId(this.reqData.userID)}:Ue;try{let t=await h.findOne(this.userID,{});if(!t)return{status:501,foreignData:"User doesn't exist"};let a=this.reqData.followingPhone||"";(t.contacts??!1)||(t.contacts=[]),t.contacts.includes(a)||t.contacts.push(a);let n=await t.save();return n&&Object.keys(n).length?{status:200,foreignData:n}:{status:400,foreignData:n}}catch(t){return{status:505,foreignData:t}}}async computeUser(){this.userID=this.reqData.userID?{_id:new ObjectId(this.reqData.userID)}:Ue;try{let t=await h.findOne(this.userID,{});if(!t)return{status:501,foreignData:"User doesn't exist"};let a=this.reqData.weight||!1;if(!a)return{status:400,foreignData:"No Weights to be updated."};let n=t.queryWeight||!1;if(n&&n[1]){let r=n[1];r=r.map((s,l)=>Math.ceil((s+a[l])/2-1)),r[3]=Math.ceil(r[3]+1),t.queryWeight[1]=[1,r[1],r[2],r[3]]}else t.queryWeight[1]=[1,1,1,1];let i=await t.save();return i&&Object.keys(i).length?{status:200,foreignData:i}:{status:400,foreignData:i}}catch(t){return{status:505,foreignData:t}}}async saveItem(t=!0){return this.createNew=t,this.reqData.id==null?this.modalId=Ue:this.modalId={_id:new ObjectId(this.reqData.id)},await this.save()}async deleteItem(){return this.reqData.id==null?{status:401,foreignData:""}:(this.modalId={_id:new ObjectId(this.reqData.id)},await this.delete())}async save(){try{let t=await this.model.findOne(this.modalId,{});if(t)Object.assign(t,this.reqData);else if(this.createNew)t=new this.model(this.reqData);else return{status:501,foreignData:"Client Doesn't exist"};let a=await t.save();return a&&Object.keys(a).length?{status:200,foreignData:a}:{status:400,foreignData:a}}catch(t){return{status:505,foreignData:t}}}async delete(){try{return await this.model.findByIdAndDelete(this.modalId).then(t=>t&&Object.keys(t).length?{status:200,foreignData:t}:{status:400,foreignData:t}).catch(t=>({status:400,foreignData:t}))}catch(t){return{status:505,foreignData:t}}}};async function ra(e,t,a,n){if(a=="likes"){t.weight=await u();let c=new P(null,t),f=null;try{f=await c.computeUser()}catch{}return console.log(a,`
  Sale UserData Status Result 
`,f.status),f.status!=200||(e=Object.assign(e,t),e.likes.like++,f.data=e),f}else if(a=="following"){t.followingPhone=e.phoneCode[1]+" "+e.phone,t.weight=await u();let c=new P(null,t),f=null;try{f=await c.addFollowing()}catch{}return console.log(a,`
 Sale UserData Status Result  
`,f.status),f.status!=200||(e=Object.assign(e,t),f.data=e),f}else if(a=="_itServiceRating"){t.weight=await u();let c=new P(null,t),f=null;try{f=await c.computeUser()}catch{}return console.log(a,`
 Sale UserData Status Result  
`,f.status),f.status!=200||(e=Object.assign(e,t),e._itServiceRating=e._itServiceRating+(t._itServiceRating-e._itServiceRating)/2,e._itServiceRating=Math.min(e._itServiceRating,5),f.data=e),f}else if(a=="CreateRowItem"){t.weight=await u(!0);let c=parseFloat(t.quantity??0),f=parseFloat(t.price??0),d=parseFloat(t.discount??0);return t.quantity=c>0?c:1,t.price=f>0?f:0,t.discount=d>0?d:0,e=Object.assign(e,t),e.tQs=t.quantity,e.tQ=t.quantity,{status:200,data:e}}else if(a=="UpdateRowItem"){t.weight=await u(!0);let c=parseFloat(t.quantity??0),f=parseFloat(t.price??0),d=parseFloat(t.discount??0);return t.quantity=c>0?c:1,t.price=f>0?f:0,t.discount=d>0?d:0,e=Object.assign(e,t),e.tQs=t.quantity,e.tQ=e.tQt+t.quantity,{status:200,data:e}}else if(a=="comments"){let c=Object.assign({},t.comments);c.saleitID=new ObjectId(t.id??""),c.weight=t.weight??"",c.userID=t.userID??"",c.weight=await u();let f=new P(J,c),d=null;try{d=await f.computeUser()}catch{}return console.log(a,`
 Sale UserData Status Result  
`,d.status),d.status!=200?d:n=="delete"?await f.deleteItem().then(p=>(console.log(n,`
  Sale  Status Result 
`,p.status),p.status==200&&(p.data=e),p)).catch(p=>(console.log(p),{status:401,data:p,foreignData:p})):await f.saveItem(!0).then(p=>(console.log(n,`
  Sale  Status Result 
`,p.status),p.status==200&&(p.data=e),p)).catch(p=>(console.log(p),{status:401,data:p,foreignData:p}))}else if(a=="clients"){let c=Object.assign({},t.clients);var i=parseFloat(e.quantity??1),r=parseFloat(e.tQt??0),s=parseFloat(e.tClient??0),l=parseFloat(e._stage_??1);if(n=="delete")return await new P(M,c).deleteItem().then(async d=>{if(console.log(n,`
  Sale  Status Result 
`,d.status),d.data=null,d.status==200){i=i+parseFloat(c.quantity),r=r>0?r-parseFloat(c.quantity):0,c.store=="buy"&&(s=s>0?s-1:0);let p=await Kt(e,i,r,s,l);console.log(`
 SecondaryOperation Sale  Status Result 
`,!!p),d.data=p,p||(d.status=401)}return d}).catch(d=>(console.log(d),{status:401,data:d,foreignData:d}));if(["create","update"].includes(n)){var o=e.discount>0?e.discount:e.price;let f={status:501,data:"Computing Client Error"};c.totalOnstore=i??0,c.totalTaken=r??0,c.salePrice=o??0;try{f=await na(c,e.currency??"")}catch{}if(f.status!=200)return f;c=f.data,c.contentId=t.id,c.weight=t.weight,c.userID=t.userID,c.saleitID=e.id,c.weight=await u();let d=new P(M,c),p=null;try{p=await d.computeUser()}catch{}return console.log(a,`
 Sale UserData Status Result  
`,p.status),p.status!=200?p:await d.saveItem(!0).then(async _=>{if(_.data=null,console.log(n,`
  Sale  Status Result 
`,_.status),_.status==200){i=parseFloat(c.totalOnstore??0),r=parseFloat(c.totalTaken??0),s=s+(c.newClient??0);let he=await Kt(e,i,r,s,l);console.log(`
 SecondaryOperation Sale  Status Result 
`,!!he),_.data=he,he||(_.status=401)}return _}).catch(_=>(console.log(_),{status:401,data:_,foreignData:_}))}else return{status:401,data:"no Sub Operation for  :- "+a,foreignData:"no Sub Operations"}}else return{status:401,data:"no Operation",foreignData:"no Operations"};async function u(c=!1){let f=parseInt(e.catagoryScore??1),d=parseInt(e.usageScore??1),p=parseInt(e.trendScore??1);if(c)try{d=t.usage??!1?parseInt(aa[t.usage]):d,f=t.catagory??!1?parseInt(sa[t.catagory]):f,t.catagoryScore=isNaN(f)?10:f,t.usageScore=isNaN(d)?10:d,t.trendScore=isNaN(p)?10:p+1}catch{}else e.trendScore=p+1;return[1,f,d,p]}}async function na(e,t){var a=e.served??!1,n=e.store??!1;let i=null;try{if(n=="cart"||!a)return e.store="cart",e.quantity=e.quantity??0,e.price=(e.quantity??0)*e.salePrice,e.served="Requesting",e.currency=t,e._stage_=0,i={status:200,data:e},i;if(e.salePrice){let s=parseFloat(e.quantity??1);if(s=s||1,a=="Requesting"||!e.price)if(e.totalOnstore){s>e.totalOnstore&&(s=e.totalOnstore),e.totalOnstore=e.totalOnstore-s,e.totalTaken=e.totalTaken+s;var r=parseFloat(s*e.salePrice);e.quantity=s,e.price=r,e.served="Requested",e.currency=t,e.store="buy",e.newClient=1,e.description="waiting for Delivery Infos",e._stage_=1,i={status:200,data:e}}else e.store="cart",e.currency=t,e.quantity=e.quantity??0,e.served="Requesting",e._stage_=0,i={status:200,data:e};else e.served=="Queed"&&(e._stage_=3),e.served=="Served"&&(e._stage_=4),i={status:200,data:e}}else e.store="cart",e.quantity=e.quantity??0,e.served="Requesting",e._stage_=0,i={status:200,data:e};return i}catch(s){return{status:501,data:s}}}async function Kt(e,t,a,n,i){return t??!1?(i=Math.max(Number(i),2),e.completed="no"):(e.completed="yes",i=Math.max(Number(i),4)),e.quantity=t,e.tQs=t,e.tQt=a,e.tClient=n,e.tQ=a+t,e._stage_=i,e}var de=ra;var Lt=require("mongoose"),zt=Lt.mongoose.Types.ObjectId;var We="id",Ee="id";var Gt={updatedAt:null};async function Te(e,t=null,a=null){try{let n={};e[We]??!1?n["_"+We]=new zt(e[We]):n=Gt;let i={};return await j.findOne(n).then(async r=>{if(console.log(`
-------------------New CreateSaleit--------------------------
`),console.log(`
UpdateSale >== mainOps = `,t,`
 subOps = `,a,"UpdatingOperations Ends Succefully of UserID",e.userID??!1),r==null)if(t){if(i=await de({},e,t,a),console.log(`
 mainOps = `,t,`
 subOps = `,a,"PrimaryOperations- New "),i.status!=200)return i;r=new j(i.data)}else r=new j(e);else if(t){let s=await de(r,e,t,a);if(console.log(`
 mainOps = `,t,`
 subOps = `,a,"PrimaryOperations - Updating "),s.status!=200)return s;r=s.data}else r=Object.assign(r,e);return console.log(`
 mainOps = `,t,`
 subOps = `,a,"UpdatingOperations Ends Succefully"),await r.save().then(s=>(console.log(`
 === ==============Saved Finally    =================
`,!!s),s&&Object.keys(s).length?{status:200,data:s,foreignData:i.foreignData??{status:401}}:{status:501,data:s})).catch(s=>({status:501,data:s}))}).catch(r=>({status:501,data:r}))}catch(n){return{status:501,data:n}}}async function N(e,t=null,a=null){try{let n={};e[Ee]??!1?n["_"+Ee]=new zt(e[Ee]):n=Gt;let i={};return await j.findOne(n).then(async r=>{if(console.log(`
-------------------New UpdateSaleit--------------------------
`),console.log(`
UpdateSale >== mainOps = `,t,`
 subOps = `,a,`
 UpdatingOperations Ends Succefully of UserID`,e.userID??!1),r==null)return{status:404,data:"Saleit Record Doesn't Found."};if(t){if(i=await de(r,e,t,a),console.log("_primaryOperations UpdateSale ==<",i.status,`
`),i.status!=200)return i;r=Object.assign(r,i.data)}else r=Object.assign(r,e);return await r.save().then(s=>(console.log(`
 === ==============Saved Finally    =================
`,!!s),s&&Object.keys(s).length?{status:200,data:s,foreignData:i.foreignData??{status:401}}:{status:501,data:s})).catch(s=>({status:500,data:s}))}).catch(r=>({status:500,data:r}))}catch(n){return{status:500,data:n}}}var cn=Jt.mongoose.Types.ObjectId,D=(0,Vt.Router)(),Yt=J,V="/saleitChat";var Y={"Content-Type":"application/json","Content-Length":"5050",ETag:"Roaw"},Be="comments",ia="update",la="create",oa="delete",ua="id",ca="id";D.post(V,async(e,t)=>{let[a,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1],r={};return r=e.body??{},(r[ua]??null)==null?t.status(404).send("Create Key Null"+r):(r.userID=n,await N(r,Be,la).then(s=>(console.log(s.status,`
Clients Response Creating New
`),t.set(Y),t.status(s.status).send(s))))});D.put(V,async(e,t)=>{let[a,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1],r={};return r=e.body??{},(r[ca]??null)==null?t.status(404).send("Uppdate Key Null"+r):(r.userID=n,await N(r,Be,ia).then(s=>(console.log(s.status,`
Clients Response Creating New
`),t.set(Y),t.status(s.status).send(s))))});D.get(V+"s",async(e,t)=>{let[a,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1],r=e.query??e.params;(r??!1)&&Object.keys(r).length;let[s=[],l=[],o=10]=await m(r),u={createdAt:-1};try{let c=await w(Yt,s,l,o,u);return t.set(Y),t.status(c.status).json(c.data)}catch(c){return t.status(500).send(c)}});D.get(V,async(e,t)=>{let[a,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1],r=e.query??e.params;if(!((r??!1)&&Object.keys(r).length))return t.status(400).send("Search Query is null ?");let[s=[],l=[],o=10]=await m(r),u={createdAt:-1};try{let c=await b(Yt,s,l,o,u);return t.set(Y),t.status(c.status).json(c.data)}catch(c){return t.status(500).send(c)}});D.delete(V,async(e,t)=>{let[a,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1],r=e.query??e.params??{};if(Object.keys(r).length==0)return t.status(404).send("Body is null ?");console.log(`
Clients Response Creating New
`),r.userID=n;try{return await N(r,Be,oa).then(s=>(console.log(s.status,`
Clients Response Creating New
`),t.set(Y),t.status(s.status).send(s)))}catch(s){return t.status(500).send(s)}});var Xt=D;var Zt=require("express"),da=v(require("multer")),qt=require("mongoose");var fa=qt.mongoose.Types.ObjectId,A=(0,Zt.Router)(),F=Re,X="/publicchat";var Z={"Content-Type":"application/json","Content-Length":"5000",ETag:"Roaw","Set-Cookie":["type=ninja","language=javascript"]};var Qt="phone";async function pa(e){try{let t={};return t[Qt]=!1,await F.findOne(t,{}).then(async a=>{if(a==null)a=new F(e);else return{status:404,data:"Dubplication Occured"};return console.log("------------------------------------------>Existed Profile",a),await a.save().then(n=>n&&Object.keys(n).length?{status:200,data:n}:{status:404,data:n}).catch(n=>({status:404,data:n}))}).catch(a=>({status:404,data:a}))}catch{return{status:404,data:"Fatal DATABASE ERROR"}}}async function ga(e){console.log("------------------------------------------>Existed Profile");try{let t={};return e.id??!1?t._id=new fa(e.id):t[Qt]=!1,await F.findOne({$or:t},{}).then(async a=>a==null?{status:404,data:"Not REgistered"}:(a=Object.assign(a,e),await a.save().then(n=>n&&Object.keys(n).length?{status:200,data:n}:{status:404,data:n}).catch(n=>({status:404,data:n})))).catch(a=>({status:404,data:a}))}catch{return{status:404,data:"Fatal DATABASE ERROR"}}}A.post(X,async(e,t)=>{let[a,n,i]=[e._issrole??!1,e.userId??!1,e.queryWeight??!1],r=e?.body??!1;return!r||Object.keys(r).length==0?t.status(404).send({message:"NullData Body Received."}):await pa(r).then(s=>s.status==200?(t.set(Z),t.status(s.status).json(s.data)):t.status(s.status).send(s.data)).catch(s=>t.status(404).send(s))});A.put(X,g,async(e,t)=>{let[a,n,i]=[e._issrole??!1,e.userId??!1,e.queryWeight??!1],r=e?.body??!1;return!r||Object.keys(r).length==0?t.status(404).send({message:"NullData Body Received."}):await ga(r).then(s=>s.status==200?(t.set(Z),t.status(s.status).json(s.data)):t.status(s.status).send(s.data)).catch(s=>t.status(404).send(s))});A.get(X+"s",g,async(e,t)=>{let[a,n,i]=[e._issrole??!1,e.userId??!1,e.queryWeight??!1],r=e.query??e.params;!(r??!1)||Object.keys(r).length==0;let[s,l,o]=await m(r);try{let u=await w(F,s,l,o);return u.status==200?(t.set(Z),t.send(u.data)):t.status(404).send("(Srv):- _read404;but, "+u.data)}catch{return t.status(500).send("(Srv);- _read500")}});A.get(X,g,async(e,t)=>{let[a,n,i]=[e._issrole??!1,e.userId??!1,e.queryWeight??!1],r=e.query??e.params;!(r??!1)||Object.keys(r).length==0;let[s,l,o]=await m(r);try{let u=await b(F,s,l,o);return console.log("reading public hatts==>>",u.data.length,s),u.status==200?(t.set(Z),t.send(u.data)):t.status(404).send("(Srv):- _readf202;but, "+u.data)}catch{return t.status(500).send("(Srv);- _readf500")}});A.delete(X,g,async(e,t)=>{let[a,n,i]=[e._issrole??!1,e.userId??!1,e.queryWeight??!1];if(!n)return t.status(404).send({message:"NullData(P) Received."});let r=e.query??e.params;!(r??!1)||Object.keys(r).length==0;try{let s=await $(F,r.id);return s.status==200?(t.set(Z),t.send(s.data)):t.status(404).send("(Srv):- _del202;but, "+s.data)}catch{return t.status(500).send("(Srv);- _del500")}});var es=A;var as=require("mongoose"),rs=require("express"),fe=v(require("multer"));var Rn=as.mongoose.Types.ObjectId,K=(0,rs.Router)(),Pn=require("fs"),q=j,Q="/saleit",x={"Content-Type":"application/json","Content-Length":"5000",ETag:"Roaw"},ts={"application/pdf":"pdf","application/zip":"zip","text/csv":"csv","text/pdf":"pdf","text/json":"json","image/jpeg":"jpeg","image/png":"png","image/svg+xml":"svg+xml","image/webp":"webp","video/mp4":"mp4","video/mkv":"mkv"},ns=()=>{var e="";return{storage:fe.default.diskStorage({filename:(t,a,n)=>{let i=ts[a.mimetype];e=a.originalname.split(".")[0].split(" ")[0]+"-"+new Date().getTime()+"."+i,n(null,e)},destination:(t,a,n)=>{n(null,"./public/"+a.fieldname)},path:(t,a,n)=>{n(null,"/"+a.fieldname+"/"+e)}}),limits:{fileSize:1e6*5},fileFilter:(t,a,n)=>{if(ts[a.mimetype])n(null,!0);else return n(null,!1)}}};var ya="phone",De="id",ss="id";K.post(Q,async(e,t)=>{let[a,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1];console.log(`

 Creating saleit`);var s=(e.query??e.params??{})?.file_??!1;let l={};if(s)(s.files??!1)&&(0,fe.default)(ns()).fields([{name:s.files,maxCount:4}])(e,t,async o=>{if(l=e.body??{},Object.keys(l).length==0)return t.status(404).send("");if(o)return t.status(404).send({message:"Uploading Error"+o});{let u=e.files??!1;if(u){let c=await E(u);l[s.files]=c[s.files]}}return l.userID=n,await Te(l,l.thisOps??"CreateRowItem").then(u=>(t.set(x),t.status(u.status).send(u.data)))});else{if(l=e.body??{},(l[ya]??null)==null)return t.status(404).send("null Post-createKey ?");l.userID=n;try{return await Te(l,l.thisOps??"CreateRowItem").then(o=>(t.set(x),t.status(o.status).send(o.data)))}catch(o){return t.status(500).send(o)}}});K.put(Q,async(e,t)=>{let[a,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1];if(!n)return t.status(401).send({message:"NullData(P + token) Received."});console.log(`
 Updating saleit UserID =`,n);var s=(e.query??e.params??{})?.file_??!1;let l={};if(s)if(s.files??!1)(0,fe.default)(ns()).fields([{name:s.files,maxCount:4}])(e,t,async o=>{if(l=e.body??{},(l[De]??null)==null)return t.status(404).send("Uppdate Key Null");if(o)return t.status(404).send({message:"Uploading Error"+o});{let u=e.files??!1;if(u){let c=await E(u);l[s.files]=c[s.files]}}return l.userID=n,await N(l,l.thisOps??"UpdateRowItem","").then(u=>(t.set(x),t.status(u.status).send(u.data)))});else return l=e.body??{},(l[De]??null)==null?t.status(404).send("Uppdate Key Null"):(l.userID=n,await N(l,l.thisOps??"UpdateRowItem").then(o=>(t.set(x),t.status(o.status).send(o.data))));else{if(l=e.body??{},(l[De]??null)==null)return t.status(404).send("Uppdate Key Null");l.userID=n;try{return await N(l,l.thisOps??"UpdateRowItem").then(o=>(t.set(x),t.status(o.status).send(o.data)))}catch(o){return t.status(500).send(o)}}});K.get(Q+"s",async(e,t)=>{let[a,n,i,r]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1,e.location??!1],s=e.query??e.params??{},[l=[],o=[],u=5,c={createdAt:-1},f=0]=await m(s);r&&(s.lat=r.lat??"",s.long=r.long??""),(s.trend??!1)&&(c.trendScore=s.trend);let d=(s.queryOperator??"-or").split("-");try{let p=d[1]=="and"?await b(q,l,o,u,c,f):await w(q,l,o,u,c,f);return console.log(`
Result:_ Searching for saleitContent gets(s)
`,p.data.length??!1,r),t.set(x),t.status(p.status).json(p.data)}catch(p){return t.status(500).send(p)}});K.get(Q,async(e,t)=>{let[a,n,i,r]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1,e.location??!1],s=e.query??e.params??{},[l=[],o=[],u=5,c={createdAt:-1},f=0]=await m(s);if(!Object.keys(l).length)return t.status(404).send({message:"NullData(P) Received."});r&&(s.lat=r.lat??"",s.long=r.long??""),(s.trend??!1)&&(c.trendScore=s.trend);let d=(s.queryOperator??"-or").split("-");try{let p=d[1]=="and"?await b(q,l,o,u,c,f):await U(q,l,o,u,c,f);return console.log(`
Result:_ Searching for saleitContent get(xs) 
`,(s.qweight?.[3]??!1)=="3",p.data.length??!1,r),t.set(x),t.status(p.status).json(p.data)}catch(p){return t.status(500).send(p)}});K.delete(Q,async(e,t)=>{let[a,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1],r=e.query??e.params??{};if((r[ss]??null)==null)return t.status(404).send("Search Query is null ?");try{let s=await $(q,r[ss]);return t.set(x),t.status(s.status).json(s.data)}catch(s){return t.status(500).send(s)}});var is=K;var ls=require("mongoose"),os=require("express");var zn=ls.mongoose.Types.ObjectId,H=(0,os.Router)();var pe=M,ee="/saleitClient";var Fe="clients",ma="update",ha="create",va="delete",ba="id",Sa="id";var te={"Content-Type":"application/json","Content-Length":"5050",ETag:"Roaw"};H.post(ee,async(e,t)=>{let[a,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1];if(!n)return t.status(401).send({message:"UserID is Null"});let r={};return r=e.body??{},(r[ba]??null)==null?t.status(404).send("Uppdate Key Null"):(r.userID=n,await N(r,Fe,ha).then(s=>(console.log(s.status,`
Clients Response Creating New
`),t.set(te),t.status(s.status).send(s))))});H.put(ee,async(e,t)=>{let[a,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1];if(!n)return t.status(401).send({message:"UserID is Null."});let r={};return r=e.body??{},(r[Sa]??null)==null?t.status(404).send("Uppdate Key Null"):(r.userID=n,await N(r,Fe,ma).then(s=>(console.log(s.data,`
Clients Response Creating New
`),t.set(te),t.status(s.status).send(s))))});H.get(ee+"s",async(e,t)=>{let[a,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1],r=e.query??e.params,[s={},l=[],o=100,u={createdAt:-1},c=0]=await m(r);Object.keys(s).length;let f=(r.queryOperator??"-or").split("-");try{let d=f[1]=="and"?await b(pe,s,l,o,u):await w(pe,s,l,o,u);return t.set(te),t.status(d.status).json(d.data)}catch(d){return t.status(500).send(d)}});H.get(ee,async(e,t)=>{let[a,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1],r=e.query??e.params,[s={},l=[],o=100,u={createdAt:-1},c=0]=await m(r);if(!Object.keys(s).length)return t.status(404).send({message:"NullData(P) Received."});let f=(r.queryOperator??"-or").split("-");try{let d=f[1]=="and"?await b(pe,s,l,o,u):await U(pe,s,l,o,u);return t.set(te),t.status(d.status).json(d.data)}catch(d){return t.status(500).send(d)}});H.delete(ee,async(e,t)=>{let[a,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1],r=e.query??e.params??{};if(Object.keys(r).length==0)return t.status(404).send("Body is null ?");console.log(`
Clients Response Creating New
`),r.userID=n;try{return await N(r,Fe,va).then(s=>(console.log(s.status,`
Clients Response Creating New
`),t.set(te),t.status(s.status).send(s)))}catch(s){return t.status(500).send(s)}});var us=H;var se=v(require("express")),ds=v(require("compression")),fs=v(require("cookie-parser")),Ae=v(require("body-parser")),ps=v(require("cors")),gs=v(require("path")),ys=v(require("dotenv"));ys.default.config();var cs=process.env.API_PORT||9100,wa=1e3*60*60*24*30;console.log(`
,----------------------------------------- IS Dev Mode ? `,process.env.devmode??!1);var ms=(0,O.ssrCreate)(()=>{let e=(0,se.default)();return e.use((0,ps.default)(Ra)),e.use((0,ds.default)()),e.use((0,fs.default)()),e.set("view engine","ejs"),e.use(Ae.default.json()),e.use(Ae.default.urlencoded({extended:!0})),e.disable("x-powered-by"),e.use(se.default.static(gs.default.join(__dirname,"src/assets"))),e.use("/public",se.default.static("public",{maxAge:"7d",etag:!0,index:!1})),e.use((t,a,n)=>(a.setHeader("X-Powered-By","YitService"),a.setHeader("X-Content-Type-Options","nosniff"),a.setHeader("Cache-Control","no-cache, no-store, must-revalidate"),a.setHeader("Pragma","no-cache"),a.setHeader("Expires","4d"),n(),!0)),e.get("/helps",(t,a)=>{a.json({message:"API is working!"}),a.send("API is working!"),a.status(200).json({message:"API is working!"}),a.status(200).send("API is working!")}),e.use("/api",ft),e.use("/permissionapi",wt),e.use("/profileapi",jt),e.use("/publicchatapi",es),e.use("/saleitapi",g,is),e.use("/saleitClientapi",g,us),e.use("/saleChatapi",g,Xt),e}),hs=(0,O.ssrListen)(async({app:e,port:t,isReady:a})=>(await a(),e.listen(cs,()=>{console.log("Server listening at port "+cs+" ; "+process.env.mongodAPI_URL)}))),ii=(0,O.ssrClose)(({listenResult:e})=>(console.log("Closing Server is Being Used",e),e.close())),vs=(0,O.ssrServeStaticContent)((e,t)=>se.default.static(e,{maxAge:wa,...t})),Ke=(0,O.ssrRenderPreloadTag)(e=>(console.log("renderPreloadTag is Being Used",e),Na.test(e)===!0?`<link rel="modulepreload" href="${e}" crossorigin>`:_a.test(e)===!0?`<link rel="stylesheet" href="${e}">`:Ia.test(e)===!0?`<link rel="preload" href="${e}" as="font" type="font/woff" crossorigin>`:Oa.test(e)===!0?`<link rel="preload" href="${e}" as="font" type="font/woff2" crossorigin>`:ka.test(e)===!0?`<link rel="preload" href="${e}" as="image" type="image/gif">`:Ca.test(e)===!0?`<link rel="preload" href="${e}" as="image" type="image/jpeg">`:ja.test(e)===!0?`<link rel="preload" href="${e}" as="image" type="image/png">`:"")),Na=/\.js$/,_a=/\.css$/,Ia=/\.woff$/,Oa=/\.woff2$/,ka=/\.gif$/,Ca=/\.jpe?g$/,ja=/\.png$/,$a=["*"],Ra={origin:function(e,t){$a.includes(e),t(null,!0)}};function He(e){return Promise.all([Promise.resolve().then(()=>(ws(),Ss))]).then(async t=>{let a=t.map(n=>n.default);for(let n=0;n<a.length;n++)try{await a[n](e)}catch(i){console.error("[Quasar SSR] middleware error:",i);return}})}var xa=process.env.PORT||3e3,Ma=/\/\//g,ye="/",Cs=ye==="/"?e=>e||"/":e=>e?(ye+e).replace(Ma,"/"):ye,Ns=__dirname,js=(0,L.join)(__dirname,"client");function $s(){return(0,L.join)(js,...arguments)}function Ua(e){let t="",a=new Set;return e.forEach(n=>{let i=ge.default[n];i!==void 0&&i.forEach(r=>{if(a.has(r)===!0)return;a.add(r);let s=(0,L.basename)(r);if(ge.default[s]!==void 0)for(let l of ge.default[s])t+=Ke(l),a.add(l);t+=Ke(r)})}),t}var Wa="document.currentScript.remove()";function Ea(e){let t=e.nonce!==void 0?' nonce="'+e.nonce+'" ':"",a=(0,Is.default)(e.state,{isJSON:!0});return"<script"+t+">window.__INITIAL_STATE__="+a+";"+Wa+"<\/script>"}async function Ta(e){let t=[];Object.assign(e,{_meta:{},onRendered:a=>{t.push(a)}});try{let a=await(0,ks.default)(e),n=await(0,_s.renderToString)(a,e);return t.forEach(i=>{i()}),typeof e.rendered=="function"&&e.rendered(),e._meta.runtimePageContent=n,e.state!==void 0&&(e._meta.headTags=Ea(e)+e._meta.headTags),e._meta.endingHeadTags+=Ua(e.modules),(0,Os.default)(e)}catch(a){throw a}}var Rs=(e,t={})=>vs($s(e),t),me={port:xa,resolve:{urlPath:Cs,root(){return(0,L.join)(Ns,...arguments)},public:$s},publicPath:ye,folders:{root:Ns,public:js},render:e=>Ta(e),serve:{static:Rs}},Le=ms(me);me.app=Le;Le.use(Cs("/"),Rs("."));var Ps=()=>He(me),Ba=(e,t,a)=>Ps().then(()=>Le(e,t,a)),Da=hs({isReady:Ps,ssrHandler:Ba,...me});0&&(module.exports={});
