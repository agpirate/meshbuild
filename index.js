var xs=Object.create;var ae=Object.defineProperty;var Ms=Object.getOwnPropertyDescriptor;var Ts=Object.getOwnPropertyNames;var Ws=Object.getPrototypeOf,Es=Object.prototype.hasOwnProperty;var Us=(e,t)=>()=>(e&&(t=e(e=0)),t);var Ge=(e,t)=>{for(var r in t)ae(e,r,{get:t[r],enumerable:!0})},Je=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Ts(t))!Es.call(e,i)&&i!==r&&ae(e,i,{get:()=>t[i],enumerable:!(n=Ms(t,i))||n.enumerable});return e};var h=(e,t,r)=>(r=e!=null?xs(Ws(e)):{},Je(t||!e||!e.__esModule?ae(r,"default",{value:e,enumerable:!0}):r,e)),Bs=e=>Je(ae({},"__esModule",{value:!0}),e);var bs={};Ge(bs,{default:()=>$r});var Ss,$r,_s=Us(()=>{Ss=require("quasar/wrappers"),$r=(0,Ss.ssrMiddleware)(({app:e,resolve:t,render:r,serve:n})=>{e.get(t.urlPath("*"),(i,s)=>{s.setHeader("Content-Type","text/html"),r({req:i,res:s}).then(a=>{s.send(a)}).catch(a=>{a.url?a.code?s.redirect(a.code,a.url):s.redirect(a.url):a.code===404?s.status(404).send("404 | Page Not Found"):s.status(500).send("500 | Internal Server Error")})})})});var Br={};Ge(Br,{default:()=>Ur});module.exports=Bs(Br);var H=require("path"),Ns=require("vue/server-renderer"),Is=h(require("serialize-javascript")),Os=h(require("./render-template.js")),me=h(require("./quasar.manifest.json")),ks=h(require("./server/server-entry.js"));var O=require("quasar/wrappers"),ps=h(require("https"));var ne=require("mongoose"),Ve="mongodb://127.0.0.1:27017/saleit",Ye="mongodb://127.0.0.1:27017/profile",Xe="mongodb://127.0.0.1:27017/chat";try{I=ne.mongoose.createConnection(Ye,{}),console.log("Connecting to saleitProfile DataBases....")}catch(e){console.log("Error Connecting to saleitProfile DB_"+e),process.exit(1)}var I,Fr=I.connection;I.once("open",e=>{console.log(`saleitProfile Database connected: ${Ye}`)});I.on("error",e=>{console.error(`saleitProfile DB connection error: ${e}`)});try{k=ne.mongoose.createConnection(Xe,{}),console.log("Connecting to saleitProfile DataBases....")}catch(e){console.log("Error Connecting to saleitProfile DB_"+e),process.exit(1)}var k,Ar=k.connection;k.once("open",e=>{console.log(`saleitProfile Database connected: ${Xe}`)});k.on("error",e=>{console.error(`saleitProfile DB connection error: ${e}`)});try{j=ne.mongoose.createConnection(Ve,{}),console.log("Connecting to saleit DataBases....")}catch(e){console.log("Error Connecting to saleitProfile DB_"+e),process.exit(1)}var j,Kr=j.connection;j.once("open",e=>{console.log(`saleit Database connected: ${Ve}`)});j.on("error",e=>{console.error(`Procurment DB connection error: ${e}`)});var be=require("mongoose"),qr=require("vue"),zr=be.mongoose.Schema,Ze=be.mongoose.Types.ObjectId;var Qe={group:{type:String,default:"client"},profile:{group:{type:String,default:"client",role:{xrole:[],clients:["likes","comment"],upgraded:["clients","likes","comment"],creatorrw:2001,creator:2001,admin:2001},enum:["upgraded","client","creator","admin","xrole"]},role:[{type:String,default:"",enum:["likes","comments","clients","*","***",""]}],capability:{type:String,default:"1010"},accstage:{type:Array,default:[]}},profileMeta:{type:String,default:"client",role:{client:["clients","likes","comments"]},enum:["upgraded","client","creator","admin"]},saleit:{group:{type:String,default:"client",role:{xrole:[],client:["likes","comments","clients"],upgraded:["clients","likes","comments"],creatorrw:2001,creator:2001,admin:2001},enum:["upgraded","client","creator","admin","xrole"]},role:[{type:String,default:"",enum:["likes","comments","clients","*","***",""]}],capability:{type:String,default:"1010"},accstage:{type:Array,default:[]}},saleitClient:{group:{type:String,default:"client",role:{xrole:[],client:["likes","comments","clients"],upgraded:["clients","likes","comments"],creatorrw:2001,creator:2001,admin:2001},enum:["upgraded","client","creator","admin","xrole"]},role:[{type:String,default:"",enum:["likes","comments","clients","*","***",""]}],capability:{type:String,default:"1010"},accstage:{type:Array,default:[]}},saleitChat:{group:{type:String,default:"client",role:{xrole:[],client:["likes","comments","clients"],upgraded:["clients","likes","comments"],creatorrw:2001,creator:2001,admin:2001},enum:["upgraded","client","creator","admin","xrole"]},role:[{type:String,default:"",enum:["likes","comments","clients","*","***",""]}],capability:{type:String,default:"1010"},accstage:{type:Array,default:[]}},publicChat:{group:{type:String,default:"client",role:{xrole:[],client:["likes","comments","clients"],upgraded:["clients","likes","comments"],creatorrw:2001,creator:2001,admin:2001},enum:["upgraded","client","creator","admin","xrole"]},role:[{type:String,default:"",enum:["likes","comments","clients","*","***",""]}],capability:{type:String,default:"1010"},accstage:{type:Array,default:[]}}};var et={_stage_:{type:Number,default:1,$ifNull:1},profile:{type:Array,default:["/saleitgr/saleitpng.png"],$ifNull:["/saleitgr/saleitpng.png"],vtype:"file"},cover:{type:String,default:"/saleitgr/saleitpng.png",$ifNull:"/saleitgr/saleitpng.png",vtype:"file"},profileMeta:{type:Array,default:[{mimetype:"",encoding:"",originalname:"",destination:"",fieldname:"",filename:"",size:"",path:"",geoLocation:""}],ifNull:[{mimetype:"",encoding:"",originalname:"",destination:"",fieldname:"",filename:"",size:"",path:"",geoLocation:""}]},userName:{type:String,Vtype:"String",default:"",$ifNull:""},name:{type:String,Vtype:"String",default:"",$ifNull:"",validRuleset:"[ val => val && val.length > 0 || 'Please type something']"},lastName:{type:String,Vtype:"String",default:"",$ifNull:""},password:{type:String,vtype:"String",default:0,$ifNull:0},enrollKey:{type:String,vtype:"String",default:"",$ifNull:""},phone:{type:Number,vtype:"Number",default:0,$ifNull:0,required:!0,index:{unique:!0,dropDups:!0,length:10}},phoneCode:{type:Array,vtype:"Array",default:["",""],$ifNull:["",""],required:!0},location:{country:{type:String,default:"",$ifNull:""},provinance:{type:String,default:"",$ifNull:""},city:{type:String,default:"",$ifNull:""},street:{type:String,default:"",$ifNull:""}},geolocation:{lat:{type:Number,vtype:"Number",default:0,$ifNull:0},long:{type:Number,vtype:"Number",default:0,$ifNull:0}},verified:{type:String,Vtype:"String",default:"0",$ifNull:"",enum:["0","1"]},cart:{type:Array,Vtype:"Array",default:[],$ifNull:[]},contacts:{type:Array,vtype:"Array",default:[],$ifNull:[],index:{length:10}},queryWeight:{1:{type:Array,Vtype:"Array",default:[1,50,50,50],$ifNull:[1,50,50,50]},2:{type:String,Vtype:"String",default:"1.1.1.1",$ifNull:"1.1.1.1"},3:{type:String,Vtype:"String",default:"1.1.1.1",$ifNull:"1.1.1.1"}},acckey:{type:Ze,ref:"threeas"},acckey2:{type:Ze,ref:"threeas"}},tt={userID:{type:String,default:""},location:{type:String,default:""},activities:{name:{type:String,default:""},amount:{type:Number,vtype:"Number",default:0}},interests:{type:String,default:""}};function b(e){var t=new Date-new Date(e),r=Math.floor(t/(1e3*60*60*24));if(r)return new Date(e).toLocaleString();var n=Math.floor(t/(1e3*60*60)),i=Math.floor(t/(1e3*60));return n%=24,i%=60,(n?n+" H,  ":"")+(i?i+" M ago":n?"":"just now")}var rt=require("mongoose"),_e=rt.mongoose.Schema,we=(e=null)=>new Date(e).toLocaleString(),at=new _e(Qe,{timestamps:we});at.method("toJSON",function(){let{__v:e,_id:t,...r}=this.toObject();return r.id=t,r});var nt=new _e(et,{timestamps:we});nt.method("toJSON",function(){let{__v:e,_id:t,...r}=this.toObject();return r.id=t,r.fupdatedAt=b(r.updatedAt),r});var it=new _e(tt,{timestamps:we});it.method("toJSON",function(){let{__v:e,_id:t,...r}=this.toObject();return r.id=t,r.fupdatedAt=b(r.updatedAt),r});var y;I.models.threeas??!1?console.log("Collections alread existed on"):(y=I.model("threeas",at),console.log(y,"New Created !"));var v;I.model.profileModel?console.log("assets Collections already existed on Procurment"):(v=I.model("profiles",nt),console.log(v,"New Created !"));var st;I.model.profileMetaModel?console.log("assets Collections already existed on Procurment"):(st=I.model("profileMetas",it),console.log(st,"New Created !"));var Ds=require("jsonwebtoken");async function ie(e){try{let t=Ds.verify(e,"itserviceKey");if(console.log(`Token Decoded For = 
`),console.log(t),t)return[t.userID??null,t.acckey??null]}catch{console.log(`Token Decoded Error = 
`)}return[null,null]}var lt=require("mongoose");ObjectId=lt.mongoose.Types.ObjectId;async function Fs(e,t,r){console.log(`

 Authentication Middlewares =========> Entering 
`);let n=e.cookies??!1,i=n?n?.access_token??!1:!1;console.log(`Cookies Finding ; Option 1 : Cookies = ${i} 
`);var s=e.headers??!1;if(typeof s=="string"){let f=s;try{s=JSON.parse(f)}catch{}}let a=s.authorization??!1,l=s.cookie??!1;if(!i){let f="";a?(a=a.split(" ")??null,f=a.length<2?null:a[1],console.log(`Cookies Finding ; Option 2 : autorization Header-Cookies = ${f} 
`)):(f=l?l.replace("access_token= ",""):"",console.log(`Cookies Finding ; Option 2 : cookie Header-Cookies = ${l} 
`)),i=f?.trim()??i}if(!i)return console.log(`Cookies Finding Error ; No Cookie Founded : Exit!
`),t.status(401).send("Access forbidden ? _cookies failed");console.log(`Cookies Finding Final Passed ;  = ${i} 
`);let o=null;var u=s?.acckey??null,c=s?._iss??null,p=s?._issmodal??null,d=s?.acckey??null;if([o,u]=await ie(i),o)await v.findOne({_id:new ObjectId(o)}).then(f=>{if(f)u=f.acckey??!1,d=f.queryWeight??!1;else return t.status(403).send("userID ; Access forbidden")}).catch(()=>t.status(403).send("userID ; Access forbidden"));else return t.status(401).send("Access forbidden ? userID failed");try{c=null,p=p??"saleit",console.log(`== Role & Permission Acckey ${u?"is OK":"No"} && Target Modal is = ${p??"No Model_Specified"}  
`),u&&p&&await y.findOne({_id:new ObjectId(u)}).then(f=>(f&&(c=f[p]??null),!0)).catch(()=>!0),console.log(`== Role & Permission  = Null for Modal = ${p??"No Model ?"} && ${c} 
`)}catch(f){return console.log(f),!0}return c?(e.userID=o,e.issId=u,e.issrole=c,e.queryWeight=d,e.params.lat=s.lat??"",e.params.long=s.long??"",e.location={lat:s.lat??"",long:s.long??""},console.log(`Ending MWare UserID = ${o} && Acckey = ${u} 
`),console.log(`
 Lat : `,s.lat??!1),r(),!0):t.status(403).send("UserRole ; Access forbidden")}var g=Fs;var ut=require("mongoose"),ct=h(require("jsonwebtoken")),dt=require("express"),ot=ut.mongoose.Types.ObjectId,pt=(0,dt.Router)(),As={"Content-Type":"application/json","Content-Length":"5000",ETag:"Roaw"};var Ks=["phone","id"];pt.post("/login",async(e,t)=>{let r=e.body??{},n=Object.keys(r),i={};if(r.token??!1){let[s,a]=await ie(r.token);s&&(i._id=new ot(s))}else{let s=Ks.every(a=>new Set(n).has(a));if(!n.length&&!s)return t.status(404).send("createKey","is Null");i.phone=r.phone}delete i.phoneCode;try{return await v.findOne(i).then(async s=>{if(s&&Object.keys(s).length){let a=new ot(s.acckey);return await y.findOne({_id:a}).then(l=>{if(l){s=s.toObject()??!1;var o=null;try{o=ct.default.sign({id:s._id,userID:s._id,acckey:l.id},"itserviceKey",{expiresIn:"1d"})}catch{}if(!o)return t.status(501).json({data:"Token Generating Error"});let u=24*60*60*1e3;return t.setHeader("authorization",`Bearer ${o}`),t.cookie("access_token",o,{maxAge:864e5,httpOnly:!0,domain:e.hostname,secure:!1,signed:!1,sameSite:"Lax"}),t.setHeader("acctype",JSON.stringify(l)),t.setHeader("token",o),t.setHeader("role",l.profile.group??null),s.acctype=l,s.token=o,s.id=s._id,console.log(e.hostname,`
 Final Checked :  == ${s.id??!1}  <= < == >User Authenticated ? with token 
 ${o}`),(r.enrollKey??!1)&&(s.enrolled=r.enrollKey==s.enrollKey),t.set(As),t.status(200).send(s)}return t.status(501).json(l)}).catch(l=>(console.log(`
 ${l}`),t.status(501).send(l)))}else return t.status(202).send(s)}).catch(s=>t.status(404).send(s))}catch(s){return t.status(505).send(s)}});var ft=pt;var gt=require("mongoose"),Ls=require("jsonwebtoken");ObjectId=gt.mongoose.Types.ObjectId;async function qs(e,t,r){var n=e.cookies??e.headers.cookie??!1,i=e.headers??!1;let s=n?.access_token??!1;if(typeof i=="string"){let d=i;try{i=JSON.parse(d)}catch{}}let a=i.authorization??!1;if(a&&(s=a.split('"')[1]?.trim()??s),!(s&&i))return t.status(403).send("Access forbidden");let l=i.id??null;var o=i?.acckey??null,u=i?._iss??null,c=i?._issmodal??null,p=i?.acckey??null;try{let d=Ls.verify(s,"itserviceKey");(!l||d)&&(l=d.userId??l,o=d.acckey??o),console.log(l,"bearToken-------------->")}catch{}if(l)await v.findOne({_id:new ObjectId(l)}).then(d=>{if(d)o=d.acckey??!1,p=d.queryWeight??!1;else return t.status(403).send("Access forbidden")}).catch(()=>t.status(403).send("Access forbidden"));else return t.status(403).send("Access forbidden");return e.userId=l,e.issId=o,e.issrole=u,e.queryWeight=p,o&&c?await y.findOne({_id:new ObjectId(o)}).then(d=>(d?u=d[c]:u=null,!0)).catch(()=>!0):(u=null,e._issrole=u,r(),!0)}var yt=qs;var vt=require("mongoose"),St=h(require("jsonwebtoken")),bt=require("express");var _=async function(e,t=[],r={},n=100,i={createdAt:-1},s=0){try{return await e.find({$or:t},r).sort(i).skip(Number(s)).limit(Number(n)).then(a=>(console.log(a.length,"or Fetching..","skips =",s,"limits =",n,"sortBy =",i),a?{status:200,data:a}:{status:200,data:a})).catch(a=>({status:501,data:a}))}catch(a){return{status:500,data:a}}},S=async function(e,t=[],r={},n=100,i={createdAt:-1},s=0){try{return await e.find({$and:t},r).sort(i).skip(Number(s)).limit(Number(n)).then(a=>(console.log(a.length,"and& Fetching..","skips =",s,"limits =",n,"sortBy =",i),a?{status:200,data:a}:{status:200,data:a})).catch(a=>({status:501,data:a}))}catch(a){return{status:500,data:a}}},W=async function(e,t=[],r={},n=100,i={createdAt:-1}){try{return await e.find({$or:t},r).sort(i).limit(n).then(s=>(console.log(s.length,"Or Fetching"),s?{status:200,data:s}:{status:200,data:s})).catch(s=>({status:501,data:s}))}catch(s){return{status:500,data:s}}},$=async function(e,t){try{return await e.findByIdAndDelete(t).then(r=>r&&Object.keys(r).length?{status:200,data:r}:{status:200,data:null}).catch(r=>({status:501,data:r}))}catch(r){return{status:500,data:r}}};var mt=require("mongoose"),Ne=mt.mongoose.Types.ObjectId;var Hs=["id","Id","ID"],zs=["saleitID","userID"];var Gs=["geoSearch","queryOperator","returnWat","limits","skips","sortBy","upload","timestamp","latest","lat","long","paginationID"];async function m(e={}){if(!e)return[!1,!1,!1,!1,!1];var t={};let r=[],n=e.limits??0,i=e.skips??0,s=e.sortBy??{createdAt:-1};return console.log(`
 Incoming Query 
`,e),[Object.keys(e).length?await Vs(e):[{}],r,n,s,i]}var le=3,Js={nearMe:5,myCity:3,myCountry:1,off:0};async function Vs(e={}){let t=[];console.log(`
 Incoming Cleared Query 
`,e);let r=e.geoSearch??"off",n=(e.queryOperator??"-or").split("-");for(let s in e){let a=s;var i=e[s]??"";if(Gs.includes(s))continue;try{i=isNaN(Number(i))?i:Number(i)}catch{}let l={};if(a=="qweight"){let o=parseInt(i[1]),u=parseInt(i[2]);console.log(`
 `,n[0]),n[0]=="productSpecific"?t=[{catagoryScore:o==0?{$gte:0}:o},{usageScore:u==0?{$gte:0}:u}]:n[0]=="userSpecific"?t=[{catagoryScore:{$gte:o-o/le,$lte:o+o/le}},{usageScore:{$gte:u-u/le,$lte:u+u/le}}]:i.length==5&&(t=[{catagoryScore:{$gte:0}},{usageScore:{$gte:0}}],t.push({trendScore:{$lte:1e4}}));break}else if(Hs.includes(s))try{l._id=new Ne(i)}catch{}else if(zs.includes(s))try{l[s]=new Ne(e[s]??"")}catch{}else l[s]=typeof i=="string"?{$regex:i,$options:"i"}:i;t.push(l)}if(e.paginationID??!1)try{t.push({_id:{$gt:new Ne(e.paginationID)}})}catch{console.log(`
 Error Formating Pagination ID ...`)}if(r!="off"&&(e.lat??!1)){let s=Js[r];t.push({$expr:{$regexMatch:{input:{$toString:"$geolocation.long"},regex:"^"+String(e.long).slice(0,s)}}}),t.push({$expr:{$regexMatch:{input:{$toString:"$geolocation.lat"},regex:"^"+String(e.lat).slice(0,s)}}})}return t.length?t=t.filter(s=>Object.keys(s).length):t=[{}],console.log(`
Yield Query 
`,t,`
 => DBs Search`),t}var oe={};async function Ie(e,t,r=!1,n=!1){console.log(`
============= Document Update ============= updateKey =`+r+" <<START>>"),oe={};for(let i in t)try{let s=t[i],a={};r??!1?a[r]=s[r]??null:a={updatedAt:null},await e.findOne(a).then(async l=>{if(l==null)l=new e(s),console.log("Creating Document =",l.updateKey??"",a," ;;Newly Creating Process Debug",l);else{if(!r)return!1;l=Object.assign(l,s),console.log("Updating Document =",l.updateKey??"",a,`;
 Incoming AccKey =`,l)}return await l.save().then(o=>(o=o.toObject()??!1,o&&Object.keys(o).length?(r&&(oe[a[r]]=o),console.log(`
============= Document Update ============ END Success `+i),{status:200,data:oe}):{status:501,data:o})).catch(o=>(console.log(o,"Creating Process Debug Error"),{status:500,data:o}))}).catch(l=>({status:500,data:l}))}catch(s){return{status:500,data:s}}return{status:200,data:oe}}var Ys=[{group:"client",saleit:{group:"client",role:["likes","comments","clients"],capability:"02220",accstage:[1,3,4,5]},profile:{group:"client",role:[""],capability:"22220",accstage:[1,3,4,5]},profileMeta:"client",saleitClient:{group:"client",role:[""],capability:"22220",accstage:[1,3,4,5]},saleitChat:{group:"client",role:[""],capability:"22220",accstage:[1,3,8]},publicChat:{group:"client",role:[""],capability:"22220",accstage:[1,3,8]}},{group:"upgraded",profile:{group:"upgraded",role:[""],capability:"22220",accstage:[1,3,4,5]},profileMeta:"upgraded",saleitClient:{group:"upgraded",role:[""],capability:"22220",accstage:[1,3,4,5]},saleitChat:{group:"upgraded",role:[""],capability:"22220",accstage:[1,3,8]},publicChat:{group:"upgraded",role:[""],capability:"22220",accstage:[1,3,8]}},{group:"creator",saleit:{group:"creator",role:[""],capability:"22220",accstage:[1,2,3,4,5]},profile:{group:"creator",role:[""],capability:"22220",accstage:[1,3,4,5]},profileMeta:"creator",saleitClient:{group:"creator",role:[""],capability:"22220",accstage:[1,2,3,4,5]},saleitChat:{group:"creator",role:[""],capability:"22220",accstage:[1,3,8]},publicChat:{group:"creator",role:[""],capability:"22220",accstage:[1,3,8]}},{group:"admin",saleit:{group:"admin",role:[""],capability:"22220",accstage:[1,2,3,4,5]},profile:{group:"admin",role:[""],capability:"22220",accstage:[1,3,4,5]},profileMeta:"admin",saleitClient:{group:"admin",role:[""],capability:"22220",accstage:[1,3,8]},saleitChat:{group:"admin",role:[""],capability:"22220",accstage:[1,3,8]},publicChat:{group:"admin",role:[""],capability:"22220",accstage:[1,3,2,3]}}],Xs="group",Zs="creator",Qs="phone";async function ht(){return console.log(`

-==--------------------------------Role & Permissions Managment---------------START`),await Ie(y,Ys,Xs).then(async e=>{console.log(`
`+Object.keys(e.data),` = Sum of Role and Permissions <=>
`);for(let i in e.data);let t=null;if(e.status==200)t=e.data[Zs]??!1;else return!0;let r=[{name:"root",lastName:"root",phone:"914424140",enrollKey:"123",acckey:t?new ObjectId(t._id):null}],n=await Ie(v,r,Qs);return console.log(`User Creating  ====>> ${n.status==200?"success":"Error"}`),console.log(`---------------------------------Role & Permissions Managment---------------END

`),!0})}var er=vt.mongoose.Types.ObjectId;ht();var E=(0,bt.Router)(),ke=y,ue="/permission",ce={"Content-Type":"application/json","Content-Length":"5050",ETag:"Roaw","Set-Cookie":["type=ninja","language=javascript"]},Oe="phone";E.post("/add",yt,async(e,t)=>{let r={},n=e.body??{};if(n[Oe]??!1)r[Oe]=n[Oe]??!1;else return t.status(303).send("req.body is null");let i=await y.findOne({group:n.upgrade??"creator"});if(i)modelQA.acckey=i._id;else return{status:303,data:"Permission Assign Error"};try{return await v.findOne(r).then(async s=>{if(s&&Object.keys(s).length){let a=new er(s.acckey);return await y.findOne({_id:a}).then(l=>{if(l){let o=St.default.sign({userID:s.id,acckey:l.id},"itserviceKey",{expiresIn:"1h"});return t.setHeader("Authorization",`Bearer ${o}`),t.cookie("access_token",o,{maxAge:9e5,httpOnly:!0,secure:!1,signed:!1}),t.setHeader("threea",JSON.stringify(l)),t.setHeader("token",JSON.stringify(o)),t.setHeader("role",l.profile.group),t.status(200).send(JSON.stringify(s))}return t.status(404).json("Permission Error")}).catch(()=>t.status(404).json({}))}else return t.status(202).send(null)}).catch(s=>t.status(404).send(s))}catch(s){return t.status(505).send(s)}});var tr="group";E.put(ue,g,async(e,t)=>{let[r,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1];if(!n)return t.status(404).send({message:"NullData(P +token) Received."});let s={};return s=e.body??{},Object.keys(s).length==0&&(s[tr]??!0)?t.status(404).send(""):(s.userID=n,documentCupdate(y,[s],"group").then(a=>(t.set(ce),t.status(a.status).send(a.data))))});E.get(ue+"s",g,async(e,t)=>{let[r,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1],s=e.query??e.params??{};Object.keys(s).length==0;let[a={},l=[],o=100]=await m(s);try{let u=await _(ke,a,l,o);return u.status==200?(t.set(ce),t.status(u.status).send(u.data)):t.status(404).send("(Srv):- _read303;but, "+u.data)}catch{return t.status(505).send("(Srv);- _read505")}});E.get(ue,g,async(e,t)=>{let[r,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1],s=e.query??e.params??{};Object.keys(s).length==0;let[a={},l=[],o=100]=await m(s);try{let u=await S(ke,a,l,o);return u.status==200?(t.set(ce),t.status(u.status).send(u.data)):t.status(404).send("(Srv):- _readf202;but, "+u.data)}catch{return t.status(505).send("(Srv);- _readf505")}});E.delete(ue,g,async(e,t)=>{let[r,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1];if(!n)return t.status(404).send({message:"NullData(P) Received."});let s=e.query??e.params??{};Object.keys(s).length==0;try{let a=await $(ke,s.id);return a.status==200?(t.set(ce),t.status(a.status).send(a.data)):t.status(404).send("(Srv):- _del202;but, "+a.data)}catch{return t.status(505).send("(Srv);- _del505")}});var _t=E;var kt=require("express"),z=h(require("multer")),jt=require("mongoose");var Na=require("multer");async function U(e){let t={};for(let a in e){t[a]=[],t[a+"Meta"]=[];var r=e[a];for(let l in r)try{var n=r[l],i="/"+n.fieldname+"/"+n.filename,s={thefilePath:i,geoLocation:"0000000000xyz"};t[a][l]=s.thefilePath,t[a+"Meta"][l]=s}catch{return!1}}return t}async function wt(e){let t={};var r={thefilePath:"/"+e.fieldname+"/"+e.filename,geoLocation:"0000000000xyz"};return t[e.fieldname]=r.thefilePath,t[e.fieldname+"Meta"]=r,t}var Nt=jt.mongoose.Types.ObjectId,D=(0,kt.Router)(),P=v,G="/profile",B={"Content-Type":"application/json","Content-Length":"5050",ETag:"Roaw","Set-Cookie":["type=ninja","language=javascript"]};var It={"application/pdf":"pdf","application/zip":"zip","text/csv":"csv","text/pdf":"pdf","text/json":"json","image/jpeg":"jpeg","image/png":"png","image/svg+xml":"svg+xml","image/webp":"webp","video/mp4":"mp4","video/mkv":"mkv"},$e=()=>{var e="";return{storage:z.default.diskStorage({filename:(t,r,n)=>{let i=It[r.mimetype];e=r.originalname.split(".")[0].split(" ")[0]+"-"+new Date().getTime()+"."+i,n(null,e)},destination:(t,r,n)=>{n(null,"./public/"+r.fieldname)},path:(t,r,n)=>{n(null,"/"+r.fieldname+"/"+e)}}),limits:{fileSize:1e6*5},fileFilter:(t,r,n)=>{if(It[r.mimetype])n(null,!0);else return n(null,!1)}}},sr={updatedAt:null},de="phone",je="id";D.post(G,async(e,t)=>{let[r,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1],s=e.query?e.query:e.params;var a=s?.file_??!1;let l={};console.log(`
<==> Profile API Creating New User == Parameters => ${s}`);try{if(a)(a.files??!1)&&(0,z.default)($e()).fields([{name:a.files,maxCount:4}])(e,t,async o=>{if(l=e.body??{},o)return t.status(303).send({message:"Uploading Error"+o});{let u=e.files??!1;if(u){let c=await U(u);l[a.files]=c[a.files]}}return l.userID=n,await Ot(l).then(u=>t.status(u.status).send(u.data))});else return l=e.body??{},(l[de]??null)==null?t.status(404).send(""):(l.userID=n,await Ot(l).then(o=>(console.log(`
Creating Status == ${o.data}

`,l),t.set(B),t.status(o.status).send(o.data))))}catch(o){return t.status(401).send(o)}});D.put(G,g,async(e,t)=>{let[r,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1];if(!n)return t.status(404).send({message:"NullData(P +token) Received."});var a=(e.query?e.query:e.params)?.file_??!1;let l={};try{if(a)a.files??!1?(0,z.default)($e()).fields([{name:a.files,maxCount:4}])(e,t,async o=>{if(l=e.body??{},o??!1)return t.status(303).send({message:"Uploading Error"+o});{let u=e.files??!1;if(console.log(`
(Multiple) File Existed as `,u,o),u){let c=await U(u);l[a.files]=c[a.files]}else return t.status(303).send({message:"Uploading Error"})}return(l[je]??null)==null?t.status(404).send(""):(l.userID=n,await Ce(l).then(u=>(t.set(B),t.status(u.status).send(u.data))))}):(a.file??!1)&&(0,z.default)($e()).single(a.file)(e,t,async o=>{if(l=e.body??{},o??!1)return t.status(303).send({message:"Uploading Error"+o});{let u=e.file??!1;if(console.log(`
(Single) File Existed as `,u,o),u){let c=await wt(u);l[a.file]=c[a.file]}else return t.status(303).send({message:"Uploading Error"})}return(l[je]??null)==null?t.status(404).send(""):(l.userID=n,await Ce(l).then(u=>(t.set(B),t.status(u.status).send(u.data))))});else return l=e.body??{},(l[je]??null)==null?t.status(404).send(""):(l.userID=n,await Ce(l,"Update_this",l.onplaySubops??!1).then(o=>(t.set(B),t.status(o.status).send(o.data))))}catch(o){return t.status(401).send(o)}});D.get(G+"s",g,async(e,t)=>{let[r,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1],s=e.query??e.params,[a={},l=[],o=100,u={createdAt:-1},c=0]=await m(s);if(!Object.keys(a).length)return t.status(404).send({message:"NullData(P) Received."});let p=(s.queryOperator??"-or").split("-");try{let d=p[1]=="and"?await S(P,a,l,o,u):await _(P,a,l,o,u);return d.status==200?t.status(d.status).send(d.data):t.status(404).send("(Srv):- _read303;but, "+d.data)}catch{return t.status(505).send("(Srv);- _read505")}});D.get(G,g,async(e,t)=>{let[r,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1],s=e.query??e.params,[a={},l=[],o=100,u={createdAt:-1},c=0]=await m(s);if(!Object.keys(a).length)return t.status(404).send({message:"NullData(P) Received."});let p=(s.queryOperator??"-or").split("-");try{let d=p[1]=="and"?await S(P,a,l,o,u):await W(P,a,l,o,u);return d.status==200?(t.set(B),t.send(d.data)):t.status(404).send("(Srv):- _readf202;but, "+d.data)}catch{return t.status(505).send("(Srv);- _readf505")}});D.delete(G,g,async(e,t)=>{let[r,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1];if(!n)return t.status(404).send({message:"NullData(P) Received."});let s=e.query??e.params;if(!(s??!1)||Object.keys(s).length==0)return t.status(404).send("NullData(P) Received.");try{let a=await $(P,s.id);return a.status==200?(t.set(B),t.send(a.data)):t.status(404).send("(Srv):- _del202;but, "+a.data)}catch{return t.status(505).send("(Srv);- _del505")}});var Ct=D;async function Ot(e){try{let t={};return e[de]??!1?t[de]=e[de]:t=sr,console.log(`
<==>CreateContent Profile Service 0=> Check Existances of Params 
`),await P.findOne(t).then(async r=>{r==null?(r=new P(e),console.log(`
 == New User Profile Created !
`)):(r=Object.assign(r,e),console.log(`
 == Exising User --> Updating User Profile With Incoming Data !
`));let n=e.group??"client",i="";console.log(`
 == Assing Role & Permission !
`);try{i=await y.findOne({group:n}),console.log(`
 == Role & Permission Acckey = ${i._id??null} == ${n}!
`)}catch(s){n=s}if(i)r.acckey=i._id;else return{status:303,data:"Permission Assign Error"};return r.phone.length==10&&(r.phone=r.phone.slice(1,9)),console.log(`oooooooooooooo
`,r.phone,"pppppppppp"),await r.save().then(s=>s&&Object.keys(s).length?{status:200,data:s}:{status:303,data:s}).catch(s=>({status:303,data:s}))}).catch(r=>({status:303,data:r}))}catch{return{status:303,data:"Fatal DATABASE ERROR"}}}var rr="id";async function Ce(e,t=null,r=null){console.log(`

 Updating Profile 
`);try{let n={};if(e.id??!1)n._id=new Nt(e[rr]);else return{status:303,data:"body.null data"};return console.log(`
<==>UpdatingContent Profile Service 0=> Check Existances of Params 
`),console.log(n),await P.findOne(n).then(async i=>{if(console.log(`
<==> Acckey = ${i.acckey??" No User"} && subOps = ${r} 
`),i==null)return{status:303,data:"Record Doesn't Found."};if(r=="updateRole"&&(e.group??!1)){console.log(`
 == Updating Role & Permission New Group = ${e.group??!1}`);let s=await y.findOne({group:e.group});s?(console.log(`
 == Profile Role Updating  acckey = ${s.id??null} && RoleGroup =${e.group}`),i=Object.assign(i,{acckey:new Nt(s.id)})):console.log(`
 == Updating Role & Permission ;- Creating New Group = ${e.group??!1} ; Failed`)}else i=Object.assign(i,e);return await i.save().then(s=>s&&Object.keys(s).length?{status:200,data:s}:{status:303,data:s}).catch(s=>({status:303,data:s}))}).catch(i=>({status:303,data:i}))}catch{return{status:303,data:"Fatal DATABASE ERROR"}}}var $t=require("mongoose"),Wa=require("vue"),ar=$t.mongoose.Schema,Pe=ar.ObjectId;var Pt={userID:{type:Pe,ref:"profiles"},content:{type:String,default:""},phone:{type:String,default:0}},Rt={comment:{type:String,vtype:"String",default:"",$ifNull:""},saleitID:{type:Pe,ref:"saleits"},userID:{type:Pe,ref:"profiles"},userName:{type:String,vtype:"String",default:"",$ifNull:""},phone:{type:Number,vtype:"Number",default:"",$ifNull:""}};var xt=require("mongoose"),Re=xt.mongoose.Schema,Aa=Re.ObjectId,Mt=(e=null)=>new Date(e).toLocaleString(),Tt=new Re(Pt,{timestamps:Mt});Tt.method("toJSON",function(){let{__v:e,_id:t,...r}=this.toObject();return r.id=t,r.fupdatedAt=b(r.updatedAt),r.fcreatedAt=b(r.createdAt),r});var Wt=new Re(Rt,{timestamps:Mt});Wt.method("toJSON",function(){let{__v:e,_id:t,...r}=this.toObject();return r.id=t,r.fupdatedAt=b(r.updatedAt),r.fcreatedAt=b(r.createdAt),r});var xe;k.model.publicChatModel?console.log("assets Collections already existed on Procurment"):xe=k.model("publicChats",Tt);var J;k.model.saleChatModel?console.log("sale it Collections already existed on saleit content"):J=k.model("contentChats",Wt);var Jt=require("mongoose"),Vt=require("express"),dn=require("multer");var Ee=require("mongoose");var Et=require("mongoose"),Me=Et.mongoose.Types.ObjectId,Te={"Home & Living":2,"Groceries & Food Delivery":10,"Fashion & Apparel":18,"Electronics & Gadgets":26,"Beauty & Personal Care":34,"Health & Wellness":42,"Baby & Kids Products":50,"Automotive Parts & Services":66,"Home Services":74,"Travel & Experiences":82,Others:100},We={New:100,Used:75,All:1},Ut={_stage_:{type:Number,vtype:"Number",default:1},userID:{type:Me,ref:"profiles",rules:[{type:"required",value:!1}]},userName:{type:String,vtype:"String",default:"",$ifNull:"",rules:[{type:"required",value:!1}]},phone:{type:Number,vtype:"Number",default:"",$ifNull:"",rules:[{type:"required",value:!0}]},phoneCode:{type:Array,vtype:"Array",default:["",""],$ifNull:["",""],required:!0,rules:[{type:"required",value:!0}]},catagory:{type:String,vtype:"String",default:"Groceries & Food Delivery",$ifNull:"Groceries & Food Delivery",enum:Object.keys(Te),rules:[{type:"required",value:!1}]},queryWeight:{type:String,vtype:"String",default:"1.1.1.1",$ifNull:"1.1.1.1",rules:[{type:"required",value:!1}]},catagoryScore:{type:Number,vtype:"Number",default:0,$ifNull:0},usageScore:{type:Number,vtype:"Number",default:0,$ifNull:0},trendScore:{type:Number,vtype:"Number",default:0,$ifNull:0},usage:{type:String,vtype:"String",default:"Used",$ifNull:"Used",enum:Object.keys(We),rules:[{type:"required",value:!0}]},saleitgr:{type:Array,default:["/saleitgr/saleitpng.png"],vtype:"file",rules:[{type:"required",value:!1}]},header:{type:String,vtype:"String",default:"....",$ifNull:"....",rules:[{type:"required",value:!1}]},content:{type:String,vtype:"String",textarea:!0,default:"....",$ifNull:"....",rules:[{type:"required",value:!1}]},quantity:{type:Number,vtype:"Number",default:0,$ifNull:0,rules:[{type:"required",value:!0},{type:"minValue",value:1},{type:"minLength",value:1},{type:"maxLength",value:9},{type:"pattern",value:"^[0-9]+$"}]},price:{type:Number,vtype:"Number",default:0,$ifNull:0,rules:[{type:"required",value:!0},{type:"minValue",value:1},{type:"minLength",value:1},{type:"maxLength",value:10},{type:"pattern",value:"^[0-9]+$"}]},currency:{type:String,vtype:"String",default:"$(US)",$ifNull:"$(US)",enum:["$(US)","ETB"],rules:[{type:"required",value:!0}]},discount:{type:Number,vtype:"Number",default:0,$ifNull:0,rules:[{type:"required",value:!1}]},tPrice:{type:Number,vtype:"Number",default:0,$ifNull:0},location:{country:{type:String,default:"",$ifNull:"",rules:[{type:"required",value:!1}]},provinance:{type:String,default:"",$ifNull:"",rules:[{type:"required",value:!1}]},city:{type:String,default:"",$ifNull:"",rules:[{type:"required",value:!1}]},street:{type:String,default:"",$ifNull:"",rules:[{type:"required",value:!1}]}},geolocation:{lat:{type:Number,vtype:"Number",default:0,$ifNull:0,rules:[{type:"required",value:!1}]},long:{type:Number,vtype:"Number",default:0,$ifNull:0,rules:[{type:"required",value:!1}]}},timer:{action:{type:String,vtype:"String",enum:["delete","expired","sold",""],default:"",$ifNull:""},hours:{type:Number,vtype:"Number",default:-1,$ifNull:-1},days:{type:Number,vtype:"Number",default:-1,$ifNull:-1}},status:{type:String,vtype:"String",default:"posted",$ifNull:"posted",enum:["posted","sold","Paused","discarded"]},likes:{like:{type:Number,vtype:"Number",default:0,$ifNull:0},dislike:{type:Number,vtype:"Number",default:0,$ifNull:0}},completed:{type:String,vtype:"String",default:"no",$ifNull:"no"},_itServiceRating:{type:Number,vtype:"Number",default:0,$ifNull:0},tClient:{type:Number,vtype:"Number",default:0,$ifNull:0},tQs:{type:Number,vtype:"Number",default:0,$ifNull:0},tQ:{type:Number,vtype:"Number",default:0,$ifNull:0},tC:{type:Number,vtype:"Number",default:0,$ifNull:0},tQC:{type:Number,vtype:"Number",default:0,$ifNull:0},tQt:{type:Number,vtype:"Number",default:0,$ifNull:0},tCt:{type:Number,vtype:"Number",default:0,$ifNull:0},tQCt:{type:Number,vtype:"Number",default:0,$ifNull:0},tQCtonD:{type:Number,vtype:"Number",default:0,$ifNull:0},tQCttech:{type:Number,vtype:"Number",default:0,$ifNull:0}},Bt={geolocation:{lat:{type:String,vtype:"String",default:"000000",$ifNull:"000000",rules:[{type:"required",value:!0}]},long:{type:String,vtype:"String",default:"000001",$ifNull:"000001",rules:[{type:"required",value:!0}]}},location:{country:{type:String,default:"",$ifNull:"",rules:[{type:"required",value:!0}]},provinance:{type:String,default:"",$ifNull:"",rules:[{type:"required",value:!0}]},city:{type:String,default:"",$ifNull:"",rules:[{type:"required",value:!0}]},street:{type:String,default:"",$ifNull:"",rules:[{type:"required",value:!1}]}},phone:{type:Number,vtype:"Number",default:"",$ifNull:"",rules:[{type:"required",value:!1}]},phoneCode:{type:Array,vtype:"Array",default:["",""],$ifNull:["",""],required:!0,rules:[{type:"required",value:!1}]},saleitID:{type:Me,ref:"saleits",rules:[{type:"required",value:!1}]},userID:{type:Me,ref:"profiles",rules:[{type:"required",value:!1}]},orderID:{type:String,vtype:"String",default:"xyxy",$ifNull:"+xyxy",rules:[{type:"required",value:!1}]},confirmID:{type:String,vtype:"String",default:"xyxy",$ifNull:"+xyxy",rules:[{type:"required",value:!1}]},quantity:{type:Number,vtype:"Number",default:0,$ifNull:0,rules:[{type:"required",value:!0}]},price:{type:Number,vtype:"Number",default:0,$ifNull:0,rules:[{type:"required",value:!1}]},currency:{type:String,vtype:"String",default:"$(US)",$ifNull:"$(US)",enum:["$(US)","GB Pound","Euro","ETB","Pound",""],rules:[{type:"required",value:!1}]},paymentMethod:{type:String,vtype:"String",default:"onDelivery",$ifNull:"onDelivery",enum:["onDelivery","TELBirr","EBCBirr","others",""],rules:[{type:"required",value:!1}]},served:{type:String,vtype:"String",default:"Requested",$ifNull:"Requested",enum:["Served","Queed","Requested","Requesting"],rules:[{type:"required",value:!1}]},store:{type:String,vtype:"String",default:"cart",$ifNull:"cart",enum:["cart","buy","bought"],rules:[{type:"required",value:!1}]},description:{type:String,vtype:"String",default:"",$ifNull:"",rules:[{type:"required",value:!1}]}};var Dt=Ee.mongoose.Schema;Ee.mongoose.set("strictQuery",!0);var Ft=(e=null)=>new Date(e).toLocaleString(),At=new Dt(Ut,{timestamps:Ft});At.method("toJSON",function(){let{__v:e,_id:t,...r}=this.toObject();r.id=t,r.fupdatedAt=b(r.updatedAt),r.fcreatedAt=b(r.createdAt);let n=String(r.phone);return r.fphone=n.slice(0,3)+"****"+n[7]+n[8],r.netPrice=(r.discount??0)||(r.price??0),r.isOpen=(r.netPrice??0)*(r.quantity??0),r});var Kt=new Dt(Bt,{timestamps:Ft});Kt.method("toJSON",function(){let{__v:e,_id:t,...r}=this.toObject();r.id=t,r.fupdatedAt=b(r.updatedAt),r.fcreatedAt=b(r.createdAt);let n=String(r.phone);return r.fphone=n.slice(0,3)+"****"+n[7]+n[8],r.cost=r.price+" "+r.currency,r});var C;j.model.saleitModel?console.log("sale it Collections already existed on saleit content"):(C=j.model("sales",At),console.log(C,"New Created !"));var T;j.model.saleitClientModel?console.log("sale it Collections already existed on saleit content"):(T=j.model("saleitClients",Kt),console.log(T,"New Created !"));var qt=require("mongoose"),Qa=require("express");ObjectId=qt.mongoose.Types.ObjectId;var Ue={updatedAt:null},R=class{constructor(t,r){console.log(`
_user_Und_foreign_Operations Init 
 With User++currentModel =`,t,` & Data of UserID= 
`,r.userID??!1),this.reqData=r,this.model=t||"",this.userID=null,this.modalId=null,this.createNew=!0}async addFollowing(){this.userID=this.reqData.userID?{_id:new ObjectId(this.reqData.userID)}:Ue;try{let t=await v.findOne(this.userID,{});if(!t)return{status:501,foreignData:"User doesn't exist"};let r=this.reqData.followingPhone||"";(t.contacts??!1)||(t.contacts=[]),t.contacts.includes(r)||t.contacts.push(r);let n=await t.save();return n&&Object.keys(n).length?{status:200,foreignData:n}:{status:400,foreignData:n}}catch(t){return{status:505,foreignData:t}}}async computeUser(){this.userID=this.reqData.userID?{_id:new ObjectId(this.reqData.userID)}:Ue;try{let t=await v.findOne(this.userID,{});if(!t)return{status:501,foreignData:"User doesn't exist"};let r=this.reqData.weight||!1;if(!r)return{status:400,foreignData:"No Weights to be updated."};let n=t.queryWeight||!1;if(n&&n[1]){let s=n[1];s=s.map((a,l)=>{if(l==0||l==3)return Math.ceil(a+1);let o=0,u=r[l];return u>a?o=Math.ceil(a+u/2):o=Math.ceil(a-u/2),(1>o||o>100)&&(o=u),console.log("----------- Weight ----Existed",a,"--New",r[l],o),o}),t.queryWeight[1]=[1,s[1],s[2],s[3]]}else t.queryWeight[1]=[1,1,1,1];let i=await t.save();return i&&Object.keys(i).length?{status:200,foreignData:i}:{status:400,foreignData:i}}catch(t){return{status:505,foreignData:t}}}async saveItem(t=!0){return this.createNew=t,this.reqData.id==null?this.modalId=Ue:this.modalId={_id:new ObjectId(this.reqData.id)},await this.save()}async deleteItem(){return this.reqData.id==null?{status:401,foreignData:""}:(this.modalId={_id:new ObjectId(this.reqData.id)},await this.delete())}async save(){try{let t=await this.model.findOne(this.modalId,{});if(t)Object.assign(t,this.reqData);else if(this.createNew)t=new this.model(this.reqData);else return{status:501,foreignData:"Client Doesn't exist"};let r=await t.save();return r&&Object.keys(r).length?{status:200,foreignData:r}:{status:400,foreignData:r}}catch(t){return{status:505,foreignData:t}}}async delete(){try{return await this.model.findByIdAndDelete(this.modalId).then(t=>t&&Object.keys(t).length?{status:200,foreignData:t}:{status:400,foreignData:t}).catch(t=>({status:400,foreignData:t}))}catch(t){return{status:505,foreignData:t}}}};async function nr(e,t,r,n){if(r=="likes"){t.weight=await u();let c=new R(null,t),p=null;try{p=await c.computeUser()}catch{}return console.log(r,`
  Sale UserData Status Result 
`,p.status),p.status!=200||(e=Object.assign(e,t),e.likes.like++,p.data=e),p}else if(r=="following"){t.followingPhone=e.phoneCode[1]+" "+e.phone,t.weight=await u();let c=new R(null,t),p=null;try{p=await c.addFollowing()}catch{}return console.log(r,`
 Sale UserData Status Result  
`,p.status),p.status!=200||(e=Object.assign(e,t),p.data=e),p}else if(r=="_itServiceRating"){t.weight=await u();let c=new R(null,t),p=null;try{p=await c.computeUser()}catch{}return console.log(r,`
 Sale UserData Status Result - Rating  
`,p.status),p.status!=200||(e=Object.assign(e,t),e._itServiceRating=e._itServiceRating+1/5,e._itServiceRating=Math.min(e._itServiceRating,5),p.data=e,console.log(e._itServiceRating)),p}else if(r=="Create_this"){t.weight=await u(!0);let c=parseFloat(t.quantity??0),p=parseFloat(t.price??0),d=parseFloat(t.discount??0);return t.quantity=c>0?c:1,t.price=p>0?p:0,t.discount=d>0?d:0,e=Object.assign(e,t),e.tQs=t.quantity,e.tQ=t.quantity,{status:200,data:e}}else if(r=="Update_this"){t.weight=await u(!0);let c=parseFloat(t.quantity??0),p=parseFloat(t.price??0),d=parseFloat(t.discount??0);return t.quantity=c>0?c:1,t.price=p>0?p:0,t.discount=d>0?d:0,e=Object.assign(e,t),e.tQs=t.quantity,e.tQ=e.tQt+t.quantity,{status:200,data:e}}else if(r=="comments"){let c=Object.assign({},t.comments);c.saleitID=new ObjectId(t.id??""),c.weight=t.weight??"",c.userID=t.userID??"",c.weight=await u();let p=new R(J,c),d=null;try{d=await p.computeUser()}catch{}return console.log(r,`
 Sale UserData Status Result  
`,d.status),d.status!=200?d:n=="delete"?await p.deleteItem().then(f=>(console.log(n,`
  Sale  Status Result 
`,f.status),f.status==200&&(f.data=e),f)).catch(f=>(console.log(f),{status:401,data:f,foreignData:f})):await p.saveItem(!0).then(f=>(console.log(n,`
  Sale  Status Result 
`,f.status),f.status==200&&(f.data=e),f)).catch(f=>(console.log(f),{status:401,data:f,foreignData:f}))}else if(r=="clients"){let c=Object.assign({},t.clients);var i=parseFloat(e.quantity??1),s=parseFloat(e.tQt??0),a=parseFloat(e.tClient??0),l=parseFloat(e._stage_??1);if(n=="delete")return await new R(T,c).deleteItem().then(async d=>{if(console.log(n,`
  Sale  Status Result 
`,d.status),d.data=null,d.status==200){i=i+parseFloat(c.quantity),s=s>0?s-parseFloat(c.quantity):0,c.store=="buy"&&(a=a>0?a-1:0);let f=await Lt(e,i,s,a,l);console.log(`
 SecondaryOperation Sale  Status Result 
`,!!f),d.data=f,f||(d.status=401)}return d}).catch(d=>(console.log(d),{status:401,data:d,foreignData:d}));if(["create","update","cart","buy"].includes(n)){var o=e.discount>0?e.discount:e.price;let p={status:501,data:"Computing Client Error"};c.totalOnstore=i??0,c.totalTaken=s??0,c.salePrice=o??0;try{p=await ir(c,e.currency??"")}catch{}if(p.status!=200)return p;c=p.data,c.contentId=t.id,c.weight=t.weight,c.userID=t.userID,c.saleitID=e.id,c.weight=await u();let d=new R(T,c),f=null;try{f=await d.computeUser()}catch{}return console.log(r,`
 Sale UserData Status Result  
`,f.status),f.status!=200?f:await d.saveItem(!0).then(async N=>{if(N.data=null,console.log(n,`
  Sale  Status Result 
`,N.status),N.status==200){i=parseFloat(c.totalOnstore??0),s=parseFloat(c.totalTaken??0),a=a+(c.newClient??0);let Se=await Lt(e,i,s,a,l);console.log(`
 SecondaryOperation Sale  Status Result 
`,!!Se),N.data=Se,Se||(N.status=401)}return N}).catch(N=>(console.log(N),{status:401,data:N,foreignData:N}))}else return{status:401,data:"no Sub Operation for  :- "+r,foreignData:"no Sub Operations"}}else return{status:401,data:"no Operation",foreignData:"no Operations"};async function u(c=!1){let p=parseInt(e.catagoryScore??1),d=parseInt(e.usageScore??1),f=parseInt(e.trendScore??1);if(c)try{d=t.usage??!1?parseInt(We[t.usage]):d,p=t.catagory??!1?parseInt(Te[t.catagory]):p,t.catagoryScore=isNaN(p)?10:p,t.usageScore=isNaN(d)?10:d,t.trendScore=isNaN(f)?10:f+1}catch{}else e.trendScore=f+1;return[1,p,d,f]}}async function ir(e,t){var r=e.served??!1,n=e.store??!1;let i=null;try{if(n=="cart"||!r)return e.store="cart",e.quantity=e.quantity??0,e.price=(e.quantity??0)*e.salePrice,e.served="Requesting",e.currency=t,e._stage_=0,i={status:200,data:e},i;if(e.salePrice){let a=parseFloat(e.quantity??1);if(a=a||1,r=="Requesting"||!e.price)if(e.totalOnstore){a>e.totalOnstore&&(a=e.totalOnstore),e.totalOnstore=e.totalOnstore-a,e.totalTaken=e.totalTaken+a;var s=parseFloat(a*e.salePrice);e.quantity=a,e.price=s,e.served="Requested",e.currency=t,e.store="buy",e.newClient=1,e.description="waiting for Delivery Infos",e._stage_=1,i={status:200,data:e}}else e.store="cart",e.currency=t,e.quantity=e.quantity??0,e.served="Requesting",e._stage_=0,i={status:200,data:e};else e.served=="Queed"&&(e._stage_=3),e.served=="Served"&&(e._stage_=4),i={status:200,data:e}}else e.store="cart",e.quantity=e.quantity??0,e.served="Requesting",e._stage_=0,i={status:200,data:e};return i}catch(a){return{status:501,data:a}}}async function Lt(e,t,r,n,i){return t??!1?(i=Math.max(Number(i),2),e.completed="no"):(e.completed="yes",i=Math.max(Number(i),4)),e.quantity=t,e.tQs=t,e.tQt=r,e.tClient=n,e.tQ=r+t,e._stage_=i,e}var pe=nr;var Ht=require("mongoose"),zt=Ht.mongoose.Types.ObjectId;var Be="id",De="id";var Gt={updatedAt:null};async function Fe(e,t=null,r=null){try{let n={};e[Be]??!1?n["_"+Be]=new zt(e[Be]):n=Gt;let i={};return await C.findOne(n).then(async s=>{if(console.log(`
-------------------New CreateSaleit--------------------------
`),console.log(`
UpdateSale >== mainOps = `,t,`
 subOps = `,r,"UpdatingOperations Ends Succefully of UserID",e.userID??!1),s==null)if(t){if(i=await pe({},e,t,r),console.log(`
 mainOps = `,t,`
 subOps = `,r,"PrimaryOperations- New "),i.status!=200)return i;s=new C(i.data)}else s=new C(e);else if(t){let a=await pe(s,e,t,r);if(console.log(`
 mainOps = `,t,`
 subOps = `,r,"PrimaryOperations - Updating "),a.status!=200)return a;s=a.data}else s=Object.assign(s,e);return console.log(`
 mainOps = `,t,`
 subOps = `,r,"UpdatingOperations Ends Succefully"),await s.save().then(a=>(console.log(`
 === ==============Saved Finally    =================
`,!!a),a&&Object.keys(a).length?{status:200,data:a,foreignData:i.foreignData??{status:401}}:{status:501,data:a})).catch(a=>({status:501,data:a}))}).catch(s=>({status:501,data:s}))}catch(n){return{status:501,data:n}}}async function w(e,t=null,r=null){try{let n={};e[De]??!1?n["_"+De]=new zt(e[De]):n=Gt;let i={};return await C.findOne(n).then(async s=>{if(console.log(`
-------------------New UpdateSaleit--------------------------
`),console.log(`
UpdateSale >== mainOps = `,t,`
 subOps = `,r,`
 UpdatingOperations Ends Succefully of UserID`,e.userID??!1),s==null)return{status:404,data:"Saleit Record Doesn't Found."};if(t){if(i=await pe(s,e,t,r),console.log("_primaryOperations UpdateSale ==<",i.status,`
`),i.status!=200)return i;s=Object.assign(s,i.data)}else s=Object.assign(s,e);return await s.save().then(a=>(console.log(`
 === ==============Saved Finally    =================
`,!!a),a&&Object.keys(a).length?{status:200,data:a,foreignData:i.foreignData??{status:401}}:{status:501,data:a})).catch(a=>({status:500,data:a}))}).catch(s=>({status:500,data:s}))}catch(n){return{status:500,data:n}}}var cn=Jt.mongoose.Types.ObjectId,F=(0,Vt.Router)(),Yt=J,V="/saleitChat";var Y={"Content-Type":"application/json","Content-Length":"5050",ETag:"Roaw"},Ae="comments",lr="update",or="create",ur="delete",cr="id",dr="id";F.post(V,async(e,t)=>{let[r,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1],s={};return s=e.body??{},(s[cr]??null)==null?t.status(404).send("Create Key Null"+s):(s.userID=n,await w(s,Ae,or).then(a=>(console.log(a.status,`
Clients Response Creating New
`),t.set(Y),t.status(a.status).send(a))))});F.put(V,async(e,t)=>{let[r,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1],s={};return s=e.body??{},(s[dr]??null)==null?t.status(404).send("Uppdate Key Null"+s):(s.userID=n,await w(s,Ae,lr).then(a=>(console.log(a.status,`
Clients Response Creating New
`),t.set(Y),t.status(a.status).send(a))))});F.get(V+"s",async(e,t)=>{let[r,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1],s=e.query??e.params;(s??!1)&&Object.keys(s).length;let[a=[],l=[],o=10]=await m(s),u={createdAt:-1};try{let c=await _(Yt,a,l,o,u);return t.set(Y),t.status(c.status).json(c.data)}catch(c){return t.status(500).send(c)}});F.get(V,async(e,t)=>{let[r,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1],s=e.query??e.params;if(!((s??!1)&&Object.keys(s).length))return t.status(400).send("Search Query is null ?");let[a=[],l=[],o=10]=await m(s),u={createdAt:-1};try{let c=await S(Yt,a,l,o,u);return t.set(Y),t.status(c.status).json(c.data)}catch(c){return t.status(500).send(c)}});F.delete(V,async(e,t)=>{let[r,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1],s=e.query??e.params??{};if(Object.keys(s).length==0)return t.status(404).send("Body is null ?");console.log(`
Clients Response Creating New
`),s.userID=n;try{return await w(s,Ae,ur).then(a=>(console.log(a.status,`
Clients Response Creating New
`),t.set(Y),t.status(a.status).send(a)))}catch(a){return t.status(500).send(a)}});var Xt=F;var Zt=require("express"),pr=h(require("multer")),Qt=require("mongoose");var fr=Qt.mongoose.Types.ObjectId,K=(0,Zt.Router)(),A=xe,X="/publicchat";var Z={"Content-Type":"application/json","Content-Length":"5000",ETag:"Roaw","Set-Cookie":["type=ninja","language=javascript"]};var es="phone";async function gr(e){try{let t={};return t[es]=!1,await A.findOne(t,{}).then(async r=>{if(r==null)r=new A(e);else return{status:404,data:"Dubplication Occured"};return console.log("------------------------------------------>Existed Profile",r),await r.save().then(n=>n&&Object.keys(n).length?{status:200,data:n}:{status:404,data:n}).catch(n=>({status:404,data:n}))}).catch(r=>({status:404,data:r}))}catch{return{status:404,data:"Fatal DATABASE ERROR"}}}async function yr(e){console.log("------------------------------------------>Existed Profile");try{let t={};return e.id??!1?t._id=new fr(e.id):t[es]=!1,await A.findOne({$or:t},{}).then(async r=>r==null?{status:404,data:"Not REgistered"}:(r=Object.assign(r,e),await r.save().then(n=>n&&Object.keys(n).length?{status:200,data:n}:{status:404,data:n}).catch(n=>({status:404,data:n})))).catch(r=>({status:404,data:r}))}catch{return{status:404,data:"Fatal DATABASE ERROR"}}}K.post(X,async(e,t)=>{let[r,n,i]=[e._issrole??!1,e.userId??!1,e.queryWeight??!1],s=e?.body??!1;return!s||Object.keys(s).length==0?t.status(404).send({message:"NullData Body Received."}):await gr(s).then(a=>a.status==200?(t.set(Z),t.status(a.status).json(a.data)):t.status(a.status).send(a.data)).catch(a=>t.status(404).send(a))});K.put(X,g,async(e,t)=>{let[r,n,i]=[e._issrole??!1,e.userId??!1,e.queryWeight??!1],s=e?.body??!1;return!s||Object.keys(s).length==0?t.status(404).send({message:"NullData Body Received."}):await yr(s).then(a=>a.status==200?(t.set(Z),t.status(a.status).json(a.data)):t.status(a.status).send(a.data)).catch(a=>t.status(404).send(a))});K.get(X+"s",g,async(e,t)=>{let[r,n,i]=[e._issrole??!1,e.userId??!1,e.queryWeight??!1],s=e.query??e.params;!(s??!1)||Object.keys(s).length==0;let[a,l,o]=await m(s);try{let u=await _(A,a,l,o);return u.status==200?(t.set(Z),t.send(u.data)):t.status(404).send("(Srv):- _read404;but, "+u.data)}catch{return t.status(500).send("(Srv);- _read500")}});K.get(X,g,async(e,t)=>{let[r,n,i]=[e._issrole??!1,e.userId??!1,e.queryWeight??!1],s=e.query??e.params;!(s??!1)||Object.keys(s).length==0;let[a,l,o]=await m(s);try{let u=await S(A,a,l,o);return console.log("reading public hatts==>>",u.data.length,a),u.status==200?(t.set(Z),t.send(u.data)):t.status(404).send("(Srv):- _readf202;but, "+u.data)}catch{return t.status(500).send("(Srv);- _readf500")}});K.delete(X,g,async(e,t)=>{let[r,n,i]=[e._issrole??!1,e.userId??!1,e.queryWeight??!1];if(!n)return t.status(404).send({message:"NullData(P) Received."});let s=e.query??e.params;!(s??!1)||Object.keys(s).length==0;try{let a=await $(A,s.id);return a.status==200?(t.set(Z),t.send(a.data)):t.status(404).send("(Srv):- _del202;but, "+a.data)}catch{return t.status(500).send("(Srv);- _del500")}});var ts=K;var as=require("mongoose"),ns=require("express"),fe=h(require("multer"));var Pn=as.mongoose.Types.ObjectId,L=(0,ns.Router)(),Rn=require("fs"),Q=C,ee="/saleit",x={"Content-Type":"application/json","Content-Length":"5000",ETag:"Roaw"},ss={"application/pdf":"pdf","application/zip":"zip","text/csv":"csv","text/pdf":"pdf","text/json":"json","image/jpeg":"jpeg","image/png":"png","image/svg+xml":"svg+xml","image/webp":"webp","video/mp4":"mp4","video/mkv":"mkv"},is=()=>{var e="";return{storage:fe.default.diskStorage({filename:(t,r,n)=>{let i=ss[r.mimetype];e=r.originalname.split(".")[0].split(" ")[0]+"-"+new Date().getTime()+"."+i,n(null,e)},destination:(t,r,n)=>{n(null,"./public/"+r.fieldname)},path:(t,r,n)=>{n(null,"/"+r.fieldname+"/"+e)}}),limits:{fileSize:1e6*5},fileFilter:(t,r,n)=>{if(ss[r.mimetype])n(null,!0);else return n(null,!1)}}};var mr="phone",Ke="id",rs="id";L.post(ee,async(e,t)=>{let[r,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1];console.log(`

 Creating saleit`);var a=(e.query??e.params??{})?.file_??!1;let l={};if(a)(a.files??!1)&&(0,fe.default)(is()).fields([{name:a.files,maxCount:4}])(e,t,async o=>{if(l=e.body??{},Object.keys(l).length==0)return t.status(404).send("");if(o)return t.status(404).send({message:"Uploading Error"+o});{let u=e.files??!1;if(u){let c=await U(u);l[a.files]=c[a.files]}}return l.userID=n,await Fe(l,l.thisOps??"Create_this").then(u=>(t.set(x),t.status(u.status).send(u.data)))});else{if(l=e.body??{},(l[mr]??null)==null)return t.status(404).send("null Post-createKey ?");l.userID=n;try{return await Fe(l,l.thisOps??null,l.thisSubOps??null).then(o=>(t.set(x),t.status(o.status).send(o.data)))}catch(o){return t.status(500).send(o)}}});L.put(ee,async(e,t)=>{let[r,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1];if(!n)return t.status(401).send({message:"NullData(P + token) Received."});console.log(`
 Updating saleit UserID =`,n);var a=(e.query??e.params??{})?.file_??!1;let l={};if(a)if(a.files??!1)(0,fe.default)(is()).fields([{name:a.files,maxCount:4}])(e,t,async o=>{if(l=e.body??{},(l[Ke]??null)==null)return t.status(404).send("Uppdate Key Null");if(o)return t.status(404).send({message:"Uploading Error"+o});{let u=e.files??!1;if(u){let c=await U(u);l[a.files]=c[a.files]}}return l.userID=n,await w(l,l.thisOps??"Update_this","").then(u=>(t.set(x),t.status(u.status).send(u.data)))});else return l=e.body??{},(l[Ke]??null)==null?t.status(404).send("Uppdate Key Null"):(l.userID=n,await w(l,l.thisOps??"Update_this").then(o=>(t.set(x),t.status(o.status).send(o.data))));else{if(l=e.body??{},(l[Ke]??null)==null)return t.status(404).send("Uppdate Key Null");console.log(l,"kkkkkkkk"),l.userID=n;try{return await w(l,l.thisOps??null,l.thisSubOps??null).then(o=>(t.set(x),t.status(o.status).send(o.data)))}catch(o){return t.status(500).send(o)}}});L.get(ee+"s",async(e,t)=>{let[r,n,i,s]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1,e.location??!1],a=e.query??e.params??{};s&&(a.lat=s.lat??"",a.long=s.long??"");let[l=[],o=[],u=5,c={createdAt:-1},p=0]=await m(a);(a.trend??!1)&&(c.trendScore=a.trend);let d=(a.queryOperator??"-or").split("-");try{let f=d[1]=="and"?await S(Q,l,o,u,c,p):await _(Q,l,o,u,c,p);return console.log(`
Result:_ Searching for saleitContent gets(s)
`,f.data.length??!1,s),t.set(x),t.status(f.status).json(f.data)}catch(f){return t.status(500).send(f)}});L.get(ee,async(e,t)=>{let[r,n,i,s]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1,e.location??!1],a=e.query??e.params??{};s&&(a.lat=s.lat??"",a.long=s.long??"");let[l=[],o=[],u=5,c={createdAt:-1},p=0]=await m(a);if(!Object.keys(l).length)return t.status(404).send({message:"NullData(P) Received."});(a.trend??!1)&&(c.trendScore=a.trend);let d=(a.queryOperator??"-or").split("-");try{let f=d[1]=="and"?await S(Q,l,o,u,c,p):await W(Q,l,o,u,c,p);return console.log(`
Result:_ Searching for saleitContent get(xs) 
`,(a.qweight?.[3]??!1)=="3",f.data.length??!1,s),t.set(x),t.status(f.status).json(f.data)}catch(f){return t.status(500).send(f)}});L.delete(ee,async(e,t)=>{let[r,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1],s=e.query??e.params??{};if((s[rs]??null)==null)return t.status(404).send("Search Query is null ?");try{let a=await $(Q,s[rs]);return t.set(x),t.status(a.status).json(a.data)}catch(a){return t.status(500).send(a)}});var ls=L;var os=require("mongoose"),us=require("express");var Hn=os.mongoose.Types.ObjectId,q=(0,us.Router)();var ge=T,te="/saleitClient";var hr="clients";var vr="delete",Sr="id",br="id";var se={"Content-Type":"application/json","Content-Length":"5050",ETag:"Roaw"};q.post(te,async(e,t)=>{let[r,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1];if(!n)return t.status(401).send({message:"UserID is Null"});let s={};return s=e.body??{},(s[Sr]??null)==null?t.status(404).send("Uppdate Key Null"):(s.userID=n,await w(s,s.thisOps??null,s.thisSubOps??null).then(a=>(console.log(a.status,`
Clients Response Creating New
`),t.set(se),t.status(a.status).send(a))))});q.put(te,async(e,t)=>{let[r,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1];if(!n)return t.status(401).send({message:"UserID is Null."});let s={};return s=e.body??{},(s[br]??null)==null?t.status(404).send("Uppdate Key Null"):(s.userID=n,await w(s,s.thisOps??null,s.thisSubOps??null).then(a=>(console.log(a.data,`
Clients Response Creating New
`),t.set(se),t.status(a.status).send(a))))});q.get(te+"s",async(e,t)=>{let[r,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1],s=e.query??e.params,[a={},l=[],o=100,u={createdAt:-1},c=0]=await m(s);Object.keys(a).length;let p=(s.queryOperator??"-or").split("-");try{let d=p[1]=="and"?await S(ge,a,l,o,u):await _(ge,a,l,o,u);return t.set(se),t.status(d.status).json(d.data)}catch(d){return t.status(500).send(d)}});q.get(te,async(e,t)=>{let[r,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1],s=e.query??e.params,[a={},l=[],o=100,u={createdAt:-1},c=0]=await m(s);if(!Object.keys(a).length)return t.status(404).send({message:"NullData(P) Received."});let p=(s.queryOperator??"-or").split("-");try{let d=p[1]=="and"?await S(ge,a,l,o,u):await W(ge,a,l,o,u);return t.set(se),t.status(d.status).json(d.data)}catch(d){return t.status(500).send(d)}});q.delete(te,async(e,t)=>{let[r,n,i]=[e._issrole??!1,e.userID??!1,e.queryWeight??!1],s=e.query??e.params??{};if(Object.keys(s).length==0)return t.status(404).send("Body is null ?");s.userID=n;try{return await w(s,hr,vr).then(a=>(console.log(a.status,`
Clients Response Creating New
`),t.set(se),t.status(a.status).send(a)))}catch(a){return t.status(500).send(a)}});var cs=q;var M=h(require("express")),fs=h(require("compression")),gs=h(require("cookie-parser")),Le=h(require("body-parser")),ye=h(require("cors")),re=h(require("path")),ys=h(require("dotenv"));ys.default.config();var _r=1e3*60*60*24*30;var ds={origin:"*",methods:["GET","POST","PUT","DELETE"],allowedHeaders:["Content-Type","Authorization"],credentials:!0},ms=(0,O.ssrCreate)(()=>{let e=(0,M.default)();return e.use((0,fs.default)()),ye.default&&e.use((0,ye.default)(ds)),e.options("*",(0,ye.default)(ds)),e.use((0,gs.default)()),e.set("view engine","ejs"),e.use(Le.default.json()),e.use(Le.default.urlencoded({extended:!0})),e.use("/assets",M.default.static("src/assets")),e.use("/public",M.default.static(re.default.join(__dirname,"public"),{maxAge:"7d",etag:!0,index:!1})),e.use("/saleitgr",M.default.static(re.default.join(__dirname,"public/saleitgr"),{maxAge:"7d",etag:!0,index:!1})),e.use("/cover",M.default.static(re.default.join(__dirname,"public/cover"),{maxAge:"7d",etag:!0,index:!1})),e.use("/profile",M.default.static(re.default.join(__dirname,"public/profile"),{maxAge:"7d",etag:!0,index:!1})),e.use((t,r,n)=>(r.setHeader("X-Powered-By","YitService"),r.setHeader("Expires","4d"),n(),!0)),e.get("/helps",g,(t,r)=>{r.json({message:"API is working!"}),r.send("API is working!"),r.status(200).json({message:"API is working!"}),r.status(200).send("API is working!")}),e.use("/api",ft),e.use("/permissionapi",_t),e.use("/profileapi",Ct),e.use("/publicchatapi",ts),e.use("/saleitapi",g,ls),e.use("/saleitClientapi",g,cs),e.use("/saleChatapi",g,Xt),e}),hs=(0,O.ssrListen)(async({app:e,port:t,isReady:r})=>{await r();let n={};try{n={}}catch{}let i=ps.default.createServer(n,e);return e.listen(8080,()=>{console.log(!0+` = Prod.Mode, ServerAPI @ https://localhost:${8080} DataBase_API @ : `+process.env.mongodAPI_URL)})}),ii=(0,O.ssrClose)(({listenResult:e})=>(console.log("Closing Server is Being Used",e),e&&e.close(),!0)),vs=(0,O.ssrServeStaticContent)((e,t)=>M.default.static(e,{maxAge:_r,...t})),qe=(0,O.ssrRenderPreloadTag)(e=>(console.log("renderPreloadTag is Being Used",e),wr.test(e)===!0?`<link rel="modulepreload" href="${e}" crossorigin>`:Nr.test(e)===!0?`<link rel="stylesheet" href="${e}">`:Ir.test(e)===!0?`<link rel="preload" href="${e}" as="font" type="font/woff" crossorigin>`:Or.test(e)===!0?`<link rel="preload" href="${e}" as="font" type="font/woff2" crossorigin>`:kr.test(e)===!0?`<link rel="preload" href="${e}" as="image" type="image/gif">`:jr.test(e)===!0?`<link rel="preload" href="${e}" as="image" type="image/jpeg">`:Cr.test(e)===!0?`<link rel="preload" href="${e}" as="image" type="image/png">`:"")),wr=/\.js$/,Nr=/\.css$/,Ir=/\.woff$/,Or=/\.woff2$/,kr=/\.gif$/,jr=/\.jpe?g$/,Cr=/\.png$/;function He(e){return Promise.all([Promise.resolve().then(()=>(_s(),bs))]).then(async t=>{let r=t.map(n=>n.default);for(let n=0;n<r.length;n++)try{await r[n](e)}catch(i){console.error("[Quasar SSR] middleware error:",i);return}})}var Pr=process.env.PORT||3e3,Rr=/\/\//g,he="/",js=he==="/"?e=>e||"/":e=>e?(he+e).replace(Rr,"/"):he,ws=__dirname,Cs=(0,H.join)(__dirname,"client");function $s(){return(0,H.join)(Cs,...arguments)}function xr(e){let t="",r=new Set;return e.forEach(n=>{let i=me.default[n];i!==void 0&&i.forEach(s=>{if(r.has(s)===!0)return;r.add(s);let a=(0,H.basename)(s);if(me.default[a]!==void 0)for(let l of me.default[a])t+=qe(l),r.add(l);t+=qe(s)})}),t}var Mr="document.currentScript.remove()";function Tr(e){let t=e.nonce!==void 0?' nonce="'+e.nonce+'" ':"",r=(0,Is.default)(e.state,{isJSON:!0});return"<script"+t+">window.__INITIAL_STATE__="+r+";"+Mr+"<\/script>"}async function Wr(e){let t=[];Object.assign(e,{_meta:{},onRendered:r=>{t.push(r)}});try{let r=await(0,ks.default)(e),n=await(0,Ns.renderToString)(r,e);return t.forEach(i=>{i()}),typeof e.rendered=="function"&&e.rendered(),e._meta.runtimePageContent=n,e.state!==void 0&&(e._meta.headTags=Tr(e)+e._meta.headTags),e._meta.endingHeadTags+=xr(e.modules),(0,Os.default)(e)}catch(r){throw r}}var Ps=(e,t={})=>vs($s(e),t),ve={port:Pr,resolve:{urlPath:js,root(){return(0,H.join)(ws,...arguments)},public:$s},publicPath:he,folders:{root:ws,public:Cs},render:e=>Wr(e),serve:{static:Ps}},ze=ms(ve);ve.app=ze;ze.use(js("/"),Ps("."));var Rs=()=>He(ve),Er=(e,t,r)=>Rs().then(()=>ze(e,t,r)),Ur=hs({isReady:Rs,ssrHandler:Er,...ve});0&&(module.exports={});
